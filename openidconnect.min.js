var OIDC=namespace("OIDC");function JSONObjToHTMLTable(t){try{var e='\n<table class="table table-striped">';for(var r in t)e=e+"\n<TR><TD>"+r+"</TD><TD>"+t[r]+"</TD></TR>";return e+="\n</table>"}catch(t){throw new OidcException("Unable to get JSON Obj to HTML table:"+t.toString())}}function OidcException(t){this.name="OidcException",this.message=t}function namespace(t){for(var e=t.split("."),r=window,i="",n=0,o=e.length;n<o;n++)r[i=e[n]]=r[i]||{},r=r[i];return r}OIDC.supportedProviderOptions=["issuer","authorization_endpoint","jwks_uri","claims_parameter_supported","request_parameter_supported","jwks"],OIDC.supportedRequestOptions=["scope","response_type","display","max_age","claims","request"],OIDC.supportedClientOptions=["client_id","redirect_uri"],OIDC.supportedValidationOptions=["validator"],OIDC.setProviderInfo=function(t){var e=this.supportedProviderOptions;try{if("undefined"!==t)for(var r=0;r<e.length;r++)"undefined"!==t[e[r]]&&(this[e[r]]=t[e[r]]);return!0}catch(t){throw new OidcException("Unable to set the Identity Provider's configuration parameters: "+t.toString())}},OIDC.setClientInfo=function(t){var e=this.supportedClientOptions;try{if(void 0!==t){void 0===t.client_id&&(clientInfoFromServer=OIDC.registerClient(t.redirect_uri),t.client_id=clientInfoFromServer.client_id);for(var r=0;r<e.length;r++)void 0!==t[e[r]]&&(this[e[r]]=t[e[r]])}return!0}catch(t){throw new OidcException("Unable to set the Client's configuration parameters: "+t.toString())}},OIDC.debug=function(t,e){if(1==t){var r=sessionStorage.providerInfo,i=sessionStorage.clientInfo,n=this.verifyIdTokenSig(e),o=this.isValidIdToken(e);console.log({provider:r,client:i}),o||console.log("Id_token is not valid!"),n||console.log("The signature of the id_token is not verified!"),n&&o&&console.log("Id_token is valid and its signature is verified!")}},OIDC.storeInfo=function(t,e){var r=this.supportedProviderOptions,i=this.supportedClientOptions,n={},o={};try{if(t){for(var s=0;s<r.length;s++)void 0!==t[r[s]]&&(n[r[s]]=t[r[s]]);sessionStorage.providerInfo=JSON.stringify(n)}else sessionStorage.providerInfo&&sessionStorage.removeItem("providerInfo");if(e){for(s=0;s<i.length;s++)void 0!==e[i[s]]&&(o[i[s]]=e[i[s]]);sessionStorage.clientInfo=JSON.stringify(o)}else sessionStorage.clientInfo&&sessionStorage.removeItem("clientInfo")}catch(t){throw new OidcException("Unable to store the Identity Provider and Client configuration options: "+t.toString())}},OIDC.restoreInfo=function(){var t=sessionStorage.providerInfo,e=sessionStorage.clientInfo;try{t&&this.setProviderInfo(JSON.parse(t)),e&&this.setClientInfo(JSON.parse(e))}catch(t){throw new OidcException("Unable to restore the Identity Provider and Client configuration options: "+t.toString())}},OIDC.checkRequiredInfo=function(t){try{if(t)for(var e=0;e<t.length;e++)if(!this[t[e]])throw new OidcException("Required parameter not set - "+t[e]);return!0}catch(t){throw new OidcException("Unable to check whether the required configuration parameters are set: "+t.toString())}},OIDC.clearProviderInfo=function(){try{for(var t=0;t<this.supportedProviderOptions.length;t++)this[this.supportedProviderOptions[t]]=null}catch(t){throw new OidcException("Unable to clear the Identity Provider configuration parameters: "+t.toString())}},OIDC.generateLoginRequest=function(t){try{this.checkRequiredInfo(new Array("client_id","redirect_uri","authorization_endpoint"));var e=null,r=null,i=window.crypto||window.msCrypto;if(i&&i.getRandomValues){var n=new Uint32Array(2);i.getRandomValues(n),e=n[0].toString(36),r=n[1].toString(36)}else{var o=function(t){for(var e=0,r=t.length-1;0<=r;r--)e=256*e+t[r];return e};rng_seed_time();var s=new SecureRandom,a=new Array(4);s.nextBytes(a),e=o(a).toString(36),rng_seed_time();var h=new Array(4);s.nextBytes(h),r=o(h).toString(36)}sessionStorage.state=e,sessionStorage.nonce=r;var u="id_token",g="openid",c=null,f=null,p=null,l={},d={};if(t){if(t.response_type){var S=t.response_type.split(" "),y=[];if(S)for(var v=0;v<S.length;v++)"code"!=S[v]&&"token"!=S[v]&&"id_token"!=S[v]||y.push(S[v]);y&&(u=y.join(" "))}if(t.scope&&(g=t.scope),t.display&&(c=t.display),t.max_age&&(f=t.max_age),t.claims){if(!this.claims_parameter_supported)throw new OidcException("Provider does not support claims request parameter");if(t.claims.id_token){for(var A=0;A<t.claims.id_token.length;A++)l[t.claims.id_token[A]]=null;p||(p={}),p.id_token=l}if(t.claims.userinfo){for(var b=0;b<t.claims.userinfo.length;b++)d[t.claims.userinfo[b]]=null;p||(p={}),p.userinfo=d}}}var m="";c&&(m+="&display="+c),f&&(m+="&max_age="+f),p&&(m+="&claims="+JSON.stringify(p));var E=this.authorization_endpoint+"?response_type="+u+"&scope="+g+"&nonce="+r+"&client_id="+this.client_id+"&redirect_uri="+this.redirect_uri+"&state="+e+m;return{authorization_endpoint:this.authorization_endpoint,response_type:u,scope:g,nonce:r,client_id:this.client_id,redirect_uri:this.redirect_uri,state:e,optional_parameters:m,url:E}}catch(t){throw new OidcException("Unable to generate login request: "+t.toString())}},OIDC.login=function(t){try{this.checkRequiredInfo(new Array("client_id","redirect_uri","authorization_endpoint"));var e=!!t,r=null,i=null;e&&t.nonce&&t.state&&(r=t.state,i=t.nonce);var n=window.crypto||window.msCrypto;if(n&&n.getRandomValues){var o=new Uint32Array(2);n.getRandomValues(o),r=e&&t.state?t.state:o[0].toString(36),i=e&&t.nonce?t.nonce:o[1].toString(36)}else{var s=function(t){for(var e=0,r=t.length-1;0<=r;r--)e=256*e+t[r];return e};rng_seed_time();var a=new SecureRandom,h=new Array(4);a.nextBytes(h),r=s(h).toString(36),rng_seed_time();var u=new Array(4);a.nextBytes(u),i=s(u).toString(36)}sessionStorage.state=r,sessionStorage.nonce=i;var g="id_token",c="openid",f=null,p=null,l=null,d={},S={};if(e){if(t.response_type){var y=t.response_type.split(" "),v=[];if(y)for(var A=0;A<y.length;A++)"code"!=y[A]&&"token"!=y[A]&&"id_token"!=y[A]||v.push(y[A]);v&&(g=v.join(" "))}if(t.scope&&(c=t.scope),t.display&&(f=t.display),t.max_age&&(p=t.max_age),t.claims){if(!this.claims_parameter_supported)throw new OidcException("Provider does not support claims request parameter");if(t.claims.id_token){for(var b=0;b<t.claims.id_token.length;b++)d[t.claims.id_token[b]]=null;l||(l={}),l.id_token=d}if(t.claims.userinfo){for(var m=0;m<t.claims.userinfo.length;m++)S[t.claims.userinfo[m]]=null;l||(l={}),l.userinfo=S}}}var E="";f&&(E+="&display="+f),p&&(E+="&max_age="+p),l&&(E+="&claims="+JSON.stringify(l));var x=this.authorization_endpoint+"?response_type="+g+"&scope="+c+"&nonce="+i+"&client_id="+this.client_id+"&redirect_uri="+this.redirect_uri+"&state="+r+E;if(t.window)return window.open(x,"_blank",t.window);window.location.replace(x)}catch(t){throw new OidcException("Unable to redirect to the Identity Provider for authenticaton: "+t.toString())}},OIDC.verifyIdTokenSig=function(t){try{var e=!1;if(!(this.jwks_uri||this.jwks))throw new OidcException("jwks_uri or jwks parameter not set");if(t){var r=this.getIdTokenParts(t),i=this.getJsonObject(r[0]),n=this.jwks||this.fetchJSON(this.jwks_uri);if(!n)throw new OidcException("No JWK keyset");if(!i.alg||"RS"!=i.alg.substr(0,2))throw new OidcException("Unsupported JWS signature algorithm "+i.alg);var o=this.jwk_get_key(n,"RSA","sig",i.kid);o?e=this.rsaVerifyJWS(t,o[0]):new OidcException("No matching JWK found")}return e}catch(t){throw new OidcException("Unable to verify the ID Token signature: "+t.toString())}},OIDC.isValidIdToken=function(t){try{var e=!1;if(this.checkRequiredInfo(["issuer","client_id"]),t){var r=this.getIdTokenParts(t),i=this.getJsonObject(r[1]);if(!i)throw new OidcException("Unable to parse JWS payload");var n=new Date/1e3;if(i.iat>n+300)throw new OidcException("ID Token issued time is later than current time");if(i.exp<n-300)throw new OidcException("ID Token expired");var o=null;if(i.aud&&(o=i.aud instanceof Array?i.aud[0]:i.aud),o!=this.client_id)throw new OidcException("invalid audience");if(i.iss!=this.issuer)throw new OidcException("invalid issuer "+i.iss+" != "+this.issuer);if(i.nonce!=sessionStorage.nonce)throw new OidcException("invalid nonce");e=!0}return e}catch(t){throw new OidcException("Unable to validate information in the ID Token: "+t.toString())}},OIDC.rsaVerifyJWS=function(t,e){try{if(t&&"object"==typeof e){if("RSA"!=e.kty)throw new OidcException("No RSA kty in JWK");var r=KJUR.jws.JWS;if(e.n&&e.e){var i=KEYUTIL.getKey({kty:"RSA",n:e.n,e:e.e});return r.verify(t,i,["RS256"])}if(e.x5c)return r.verifyJWSByPemX509Cert(t,"-----BEGIN CERTIFICATE-----\n"+e.x5c[0]+"\n-----END CERTIFICATE-----\n")}}catch(t){throw new OidcException("Unable to verify the JWS string: "+t.toString())}},OIDC.getValidIdToken=function(t){try{var e=window.location.href,r=e.match("[?&]error=([^&]*)");if(r){var i=e.match("[?&]error_description=([^&]*)");throw new OidcException(r[1]+" Description: "+i[1])}var n=t&&t.validator&&"function"==typeof t.validator,o=OIDC.getState(),s=sessionStorage.state,a=n?t.validator(o,s):o===s,h=e.match("[?#&]id_token=([^&]*)");if(!a)throw new OidcException("State mismatch");if(!h)throw new OidcException("No ID Token returned");var u=h[1];if(!u)throw new OidcException("Could not retrieve ID Token from the URL");var g=this.verifyIdTokenSig(u),c=this.isValidIdToken(u);if(g&&c)return u}catch(t){throw new OidcException("Unable to get the ID Token from the current page URL: "+t.toString())}},OIDC.getState=function(){try{var t=window.location.href.match("[?&]state=([^&]*)");return t&&t[1]?decodeURIComponent(t[1]):(console.error(new Error("No State parameter found on current page URL!")),null)}catch(t){throw new OidcException("Unable to get the State from the current page URL: "+t.toString())}},OIDC.getAccessToken=function(){try{var t=window.location.href.match("[?#&]access_token=([^&]*)");return t?t[1]:(console.error(new Error("No access_token found on current page URL!")),null)}catch(t){throw new OidcException("Unable to get the Access Token from the current page URL: "+t.toString())}},OIDC.getCode=function(){try{var t=window.location.href.match("[?&]code=([^(&)]*)");if(t)return t[1]}catch(t){throw new OidcException("Unable to get the Authorization Code from the current page URL: "+t.toString())}},OIDC.getIdTokenParts=function(t){try{var e=new KJUR.jws.JWS;return e.parseJWS(t),new Array(e.parsedJWS.headS,e.parsedJWS.payloadS,e.parsedJWS.si)}catch(t){throw new OidcException("Unable to split the ID Token string: "+t.toString())}},OIDC.getIdTokenPayload=function(t){try{var e=this.getIdTokenParts(t);if(e)return this.getJsonObject(e[1])}catch(t){throw new OidcException("Unable to get the contents of the ID Token payload: "+t.toString())}},OIDC.getJsonObject=function(t){try{var e=KJUR.jws.JWS;if(e.isSafeJSONString(t))return e.readSafeJSONString(t)}catch(t){throw new OidcException("Unable to get the JSON object from JSON string: "+t.toString())}},OIDC.fetchJSON=function(e){try{var t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(null),200===t.status)return t.responseText;throw new OidcException("fetchJSON - "+t.status+" "+t.statusText)}catch(t){throw new OidcException("Unable to retrieve JSON file at "+e+" : "+t.toString())}return null},OIDC.jwk_get_key=function(t,e,r,i){try{var n=null,o=[];if(t&&("string"==typeof t?n=this.getJsonObject(t):"object"==typeof t&&(n=t),null!=n&&"object"==typeof n.keys)){if(0==n.keys.length)return null;for(var s=0;s<n.keys.length;s++)n.keys[s].kty==e&&o.push(n.keys[s]);if(0==o.length)return null;if(r){for(var a=[],h=0;h<o.length;h++)o[h].use?o[h].use==r&&a.push(o[h]):a.push(o[h]);o=a}if(0==o.length)return null;if(i){a=[];for(var u=0;u<o.length;u++)o[u].kid==i&&a.push(o[u]);o=a}return 0==o.length?null:o}}catch(t){throw new OidcException("Unable to retrieve the JWK key: "+t.toString())}},OIDC.discover=function(t){try{var e=null;if(t){var r=t+"/.well-known/openid-configuration",i=this.fetchJSON(r);i&&(e=this.getJsonObject(i))}return e}catch(t){throw new OidcException("Unable to perform discovery: "+t.toString())}},OIDC.getUserInfo=function(t){try{var e=JSON.parse(sessionStorage.providerInfo).issuer,r=OIDC.discover(e),i=new XMLHttpRequest;if(i.open("POST",r.userinfo_endpoint,!1),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.setRequestHeader("authorization","Bearer "+t),i.send(null),200===i.status)return i.responseText;throw new OidcException("getUserInfo - "+i.status+" "+i.statusText)}catch(t){throw new OidcException("Unable to get user info:"+t.toString())}},OIDC.registerClient=function(t){try{var e={redirect_uris:[t],application_type:"Web",client_name:"Dynamically Registered Client",subject_type:"public",grant_types:["implicit"],response_types:["token","id_token"],scopes:["email","openid","profile"]},r=new XMLHttpRequest;if(r.open("POST",providerInfo.registration_endpoint,!1),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.send(JSON.stringify(e)),200===r.status)return JSON.parse(r.responseText);throw new OidcException("getUserInfo - "+r.status+" "+r.statusText)}catch(t){throw new OidcException("Unable to register new client:"+t.toString())}},OidcException.prototype=new Error,OidcException.prototype.constructor=OidcException;var CryptoJS=CryptoJS||function(g,t){var r=Object.create||function(){function r(){}return function(t){var e;return r.prototype=t,e=new r,r.prototype=null,e}}(),e={},i=e.lib={},n=i.Base={extend:function(t){var e=r(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},c=i.WordArray=n.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,r=t.words,i=this.sigBytes,n=t.sigBytes;if(this.clamp(),i%4)for(var o=0;o<n;o++){var s=r[o>>>2]>>>24-o%4*8&255;e[i+o>>>2]|=s<<24-(i+o)%4*8}else for(o=0;o<n;o+=4)e[i+o>>>2]=r[o>>>2];return this.sigBytes+=n,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=g.ceil(e/4)},clone:function(){var t=n.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e,r=[],i=function(e){e=e;var r=987654321,i=4294967295;return function(){var t=((r=36969*(65535&r)+(r>>16)&i)<<16)+(e=18e3*(65535&e)+(e>>16)&i)&i;return t/=4294967296,(t+=.5)*(.5<g.random()?1:-1)}},n=0;n<t;n+=4){var o=i(4294967296*(e||g.random()));e=987654071*o(),r.push(4294967296*o()|0)}return new c.init(r,t)}}),o=e.enc={},s=o.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n++){var o=e[n>>>2]>>>24-n%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i+=2)r[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new c.init(r,e/2)}},a=o.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n++){var o=e[n>>>2]>>>24-n%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i++)r[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new c.init(r,e)}},h=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(a.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return a.parse(unescape(encodeURIComponent(t)))}},u=i.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,r=e.words,i=e.sigBytes,n=this.blockSize,o=i/(4*n),s=(o=t?g.ceil(o):g.max((0|o)-this._minBufferSize,0))*n,a=g.min(4*s,i);if(s){for(var h=0;h<s;h+=n)this._doProcessBlock(r,h);var u=r.splice(0,s);e.sigBytes-=a}return new c.init(u,a)},clone:function(){var t=n.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),f=(i.Hasher=u.extend({cfg:n.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(r){return function(t,e){return new r.init(e).finalize(t)}},_createHmacHelper:function(r){return function(t,e){return new f.HMAC.init(r,e).finalize(t)}}}),e.algo={});return e}(Math);!function(){var t=CryptoJS,e=(i=t.lib).WordArray,r=i.Hasher,g=[],i=t.algo.SHA1=r.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var r=this._hash.words,i=r[0],n=r[1],o=r[2],s=r[3],a=r[4],h=0;h<80;h++){if(h<16)g[h]=0|t[e+h];else{var u=g[h-3]^g[h-8]^g[h-14]^g[h-16];g[h]=u<<1|u>>>31}u=(i<<5|i>>>27)+a+g[h],u=h<20?u+(1518500249+(n&o|~n&s)):h<40?u+(1859775393+(n^o^s)):h<60?u+((n&o|n&s|o&s)-1894007588):u+((n^o^s)-899497514),a=s,s=o,o=n<<30|n>>>2,n=i,i=u}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(r/4294967296),e[15+(i+64>>>9<<4)]=r,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=r._createHelper(i),t.HmacSHA1=r._createHmacHelper(i)}(),function(n){for(var t=CryptoJS,e=(i=t.lib).WordArray,r=i.Hasher,i=t.algo,o=[],l=[],s=function(t){return 4294967296*(t-(0|t))|0},a=2,h=0;h<64;){var u;t:{u=a;for(var g=n.sqrt(u),c=2;c<=g;c++)if(!(u%c)){u=!1;break t}u=!0}u&&(h<8&&(o[h]=s(n.pow(a,.5))),l[h]=s(n.pow(a,1/3)),h++),a++}var d=[];i=i.SHA256=r.extend({_doReset:function(){this._hash=new e.init(o.slice(0))},_doProcessBlock:function(t,e){for(var r=this._hash.words,i=r[0],n=r[1],o=r[2],s=r[3],a=r[4],h=r[5],u=r[6],g=r[7],c=0;c<64;c++){if(c<16)d[c]=0|t[e+c];else{var f=d[c-15],p=d[c-2];d[c]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+d[c-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+d[c-16]}f=g+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&h^~a&u)+l[c]+d[c],p=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&n^i&o^n&o),g=u,u=h,h=a,a=s+f|0,s=o,o=n,n=i,i=f+p|0}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0,r[5]=r[5]+h|0,r[6]=r[6]+u|0,r[7]=r[7]+g|0},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=n.floor(r/4294967296),e[15+(i+64>>>9<<4)]=r,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA256=r._createHelper(i),t.HmacSHA256=r._createHmacHelper(i)}(Math),function(t){var e,r=(e=CryptoJS).lib,n=r.Base,o=r.WordArray;(e=e.x64={}).Word=n.extend({init:function(t,e){this.high=t,this.low=e}}),e.WordArray=n.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,r=[],i=0;i<e;i++){var n=t[i];r.push(n.high),r.push(n.low)}return o.create(r,this.sigBytes)},clone:function(){for(var t=n.clone.call(this),e=t.words=this.words.slice(0),r=e.length,i=0;i<r;i++)e[i]=e[i].clone();return t}})}(),function(){function t(){return i.create.apply(i,arguments)}for(var e=CryptoJS,r=e.lib.Hasher,i=(o=e.x64).Word,n=o.WordArray,o=e.algo,et=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],rt=[],s=0;s<80;s++)rt[s]=t();o=o.SHA512=r.extend({_doReset:function(){this._hash=new n.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var r=(u=this._hash.words)[0],i=u[1],n=u[2],o=u[3],s=u[4],a=u[5],h=u[6],u=u[7],g=r.high,c=r.low,f=i.high,p=i.low,l=n.high,d=n.low,S=o.high,y=o.low,v=s.high,A=s.low,b=a.high,m=a.low,E=h.high,x=h.low,H=u.high,w=u.low,R=g,O=c,P=f,K=p,I=l,_=d,N=S,C=y,T=v,D=A,U=b,B=m,j=E,J=x,X=H,V=w,M=0;M<80;M++){var k=rt[M];if(M<16)var L=k.high=0|t[e+2*M],F=k.low=0|t[e+2*M+1];else{L=((F=(L=rt[M-15]).high)>>>1|(q=L.low)<<31)^(F>>>8|q<<24)^F>>>7;var q=(q>>>1|F<<31)^(q>>>8|F<<24)^(q>>>7|F<<25),W=((F=(W=rt[M-2]).high)>>>19|(Y=W.low)<<13)^(F<<3|Y>>>29)^F>>>6,Y=(Y>>>19|F<<13)^(Y<<3|F>>>29)^(Y>>>6|F<<26),G=(F=rt[M-7]).high,z=(Z=rt[M-16]).high,Z=Z.low;L=(L=(L=L+G+((F=q+F.low)>>>0<q>>>0?1:0))+W+((F=F+Y)>>>0<Y>>>0?1:0))+z+((F=F+Z)>>>0<Z>>>0?1:0);k.high=L,k.low=F}G=T&U^~T&j,Z=D&B^~D&J,k=R&P^R&I^P&I;var $=O&K^O&_^K&_,Q=(q=(R>>>28|O<<4)^(R<<30|O>>>2)^(R<<25|O>>>7),W=(O>>>28|R<<4)^(O<<30|R>>>2)^(O<<25|R>>>7),(Y=et[M]).high),tt=Y.low;z=X+((T>>>14|D<<18)^(T>>>18|D<<14)^(T<<23|D>>>9))+((Y=V+((D>>>14|T<<18)^(D>>>18|T<<14)^(D<<23|T>>>9)))>>>0<V>>>0?1:0),X=j,V=J,j=U,J=B,U=T,B=D,T=N+(z=(z=(z=z+G+((Y=Y+Z)>>>0<Z>>>0?1:0))+Q+((Y=Y+tt)>>>0<tt>>>0?1:0))+L+((Y=Y+F)>>>0<F>>>0?1:0))+((D=C+Y|0)>>>0<C>>>0?1:0)|0,N=I,C=_,I=P,_=K,P=R,K=O,R=z+(k=q+k+((F=W+$)>>>0<W>>>0?1:0))+((O=Y+F|0)>>>0<Y>>>0?1:0)|0}c=r.low=c+O,r.high=g+R+(c>>>0<O>>>0?1:0),p=i.low=p+K,i.high=f+P+(p>>>0<K>>>0?1:0),d=n.low=d+_,n.high=l+I+(d>>>0<_>>>0?1:0),y=o.low=y+C,o.high=S+N+(y>>>0<C>>>0?1:0),A=s.low=A+D,s.high=v+T+(A>>>0<D>>>0?1:0),m=a.low=m+B,a.high=b+U+(m>>>0<B>>>0?1:0),x=h.low=x+J,h.high=E+j+(x>>>0<J>>>0?1:0),w=u.low=w+V,u.high=H+X+(w>>>0<V>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[30+(i+128>>>10<<5)]=Math.floor(r/4294967296),e[31+(i+128>>>10<<5)]=r,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=r._createHelper(o),e.HmacSHA512=r._createHmacHelper(o)}(),function(){var t=CryptoJS,e=(n=t.x64).Word,r=n.WordArray,i=(n=t.algo).SHA512,n=n.SHA384=i.extend({_doReset:function(){this._hash=new r.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var t=i._doFinalize.call(this);return t.sigBytes-=16,t}});t.SHA384=i._createHelper(n),t.HmacSHA384=i._createHmacHelper(n)}();var dbits,b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=";function hex2b64(t){var e,r,i="";for(e=0;e+3<=t.length;e+=3)r=parseInt(t.substring(e,e+3),16),i+=b64map.charAt(r>>6)+b64map.charAt(63&r);if(e+1==t.length?(r=parseInt(t.substring(e,e+1),16),i+=b64map.charAt(r<<2)):e+2==t.length&&(r=parseInt(t.substring(e,e+2),16),i+=b64map.charAt(r>>2)+b64map.charAt((3&r)<<4)),b64pad)for(;0<(3&i.length);)i+=b64pad;return i}function b64tohex(t){var e,r,i,n="",o=0;for(e=0;e<t.length&&t.charAt(e)!=b64pad;++e)(i=b64map.indexOf(t.charAt(e)))<0||(0==o?(n+=int2char(i>>2),r=3&i,o=1):1==o?(n+=int2char(r<<2|i>>4),r=15&i,o=2):2==o?(n+=int2char(r),n+=int2char(i>>2),r=3&i,o=3):(n+=int2char(r<<2|i>>4),n+=int2char(15&i),o=0));return 1==o&&(n+=int2char(r<<2)),n}function b64toBA(t){var e,r=b64tohex(t),i=new Array;for(e=0;2*e<r.length;++e)i[e]=parseInt(r.substring(2*e,2*e+2),16);return i}var canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);function BigInteger(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function nbi(){return new BigInteger(null)}function am1(t,e,r,i,n,o){for(;0<=--o;){var s=e*this[t++]+r[i]+n;n=Math.floor(s/67108864),r[i++]=67108863&s}return n}function am2(t,e,r,i,n,o){for(var s=32767&e,a=e>>15;0<=--o;){var h=32767&this[t],u=this[t++]>>15,g=a*h+u*s;n=((h=s*h+((32767&g)<<15)+r[i]+(1073741823&n))>>>30)+(g>>>15)+a*u+(n>>>30),r[i++]=1073741823&h}return n}function am3(t,e,r,i,n,o){for(var s=16383&e,a=e>>14;0<=--o;){var h=16383&this[t],u=this[t++]>>14,g=a*h+u*s;n=((h=s*h+((16383&g)<<14)+r[i]+n)>>28)+(g>>14)+a*u,r[i++]=268435455&h}return n}j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var rr,vv,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(t){return BI_RM.charAt(t)}function intAt(t,e){var r=BI_RC[t.charCodeAt(e)];return null==r?-1:r}function bnpCopyTo(t){for(var e=this.t-1;0<=e;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function nbv(t){var e=nbi();return e.fromInt(t),e}function bnpFromString(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var i=t.length,n=!1,o=0;0<=--i;){var s=8==r?255&t[i]:intAt(t,i);s<0?"-"==t.charAt(i)&&(n=!0):(n=!1,0==o?this[this.t++]=s:o+r>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,0<o&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),n&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,n=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(0<s--)for(a<this.DB&&0<(r=this[s]>>a)&&(n=!0,o=int2char(r));0<=s;)a<e?(r=(this[s]&(1<<a)-1)<<e-a,r|=this[--s]>>(a+=this.DB-e)):(r=this[s]>>(a-=e)&i,a<=0&&(a+=this.DB,--s)),0<r&&(n=!0),n&&(o+=int2char(r));return n?o:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;0<=--r;)if(0!=(e=this[r]-t[r]))return e;return 0}function nbits(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,e){var r;for(r=this.t-1;0<=r;--r)e[r+t]=this[r];for(r=t-1;0<=r;--r)e[r]=0;e.t=this.t+t,e.s=this.s}function bnpDRShiftTo(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s}function bnpLShiftTo(t,e){var r,i=t%this.DB,n=this.DB-i,o=(1<<n)-1,s=Math.floor(t/this.DB),a=this.s<<i&this.DM;for(r=this.t-1;0<=r;--r)e[r+s+1]=this[r]>>n|a,a=(this[r]&o)<<i;for(r=s-1;0<=r;--r)e[r]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function bnpRShiftTo(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var i=t%this.DB,n=this.DB-i,o=(1<<i)-1;e[0]=this[r]>>i;for(var s=r+1;s<this.t;++s)e[s-r-1]|=(this[s]&o)<<n,e[s-r]=this[s]>>i;0<i&&(e[this.t-r-1]|=(this.s&o)<<n),e.t=this.t-r,e.clamp()}}function bnpSubTo(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this[r]-t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t[r],e[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[r++]=this.DV+i:0<i&&(e[r++]=i),e.t=r,e.clamp()}function bnpMultiplyTo(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;0<=--n;)e[n]=0;for(n=0;n<i.t;++n)e[n+r.t]=r.am(0,i[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){for(var e=this.abs(),r=t.t=2*e.t;0<=--r;)t[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}0<t.t&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=nbi());var o=nbi(),s=this.s,a=t.s,h=this.DB-nbits(i[i.t-1]);0<h?(i.lShiftTo(h,o),n.lShiftTo(h,r)):(i.copyTo(o),n.copyTo(r));var u=o.t,g=o[u-1];if(0!=g){var c=g*(1<<this.F1)+(1<u?o[u-2]>>this.F2:0),f=this.FV/c,p=(1<<this.F1)/c,l=1<<this.F2,d=r.t,S=d-u,y=null==e?nbi():e;for(o.dlShiftTo(S,y),0<=r.compareTo(y)&&(r[r.t++]=1,r.subTo(y,r)),BigInteger.ONE.dlShiftTo(u,y),y.subTo(o,o);o.t<u;)o[o.t++]=0;for(;0<=--S;){var v=r[--d]==g?this.DM:Math.floor(r[d]*f+(r[d-1]+l)*p);if((r[d]+=o.am(0,v,r,S,0,u))<v)for(o.dlShiftTo(S,y),r.subTo(y,r);r[d]<--v;)r.subTo(y,r)}null!=e&&(r.drShiftTo(u,e),s!=a&&BigInteger.ZERO.subTo(e,e)),r.t=u,r.clamp(),0<h&&r.rShiftTo(h,r),s<0&&BigInteger.ZERO.subTo(r,r)}}}function bnMod(t){var e=nbi();return this.abs().divRemTo(t,null,e),this.s<0&&0<e.compareTo(BigInteger.ZERO)&&t.subTo(e,e),e}function Classic(t){this.m=t}function cConvert(t){return t.s<0||0<=t.compareTo(this.m)?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function cSqrTo(t,e){t.squareTo(e),this.reduce(e)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return 0<(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)?this.DV-e:-e}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var e=nbi();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&0<e.compareTo(BigInteger.ZERO)&&this.m.subTo(e,e),e}function montRevert(t){var e=nbi();return t.copyTo(e),this.reduce(e),e}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],i=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)}function montSqrTo(t,e){t.squareTo(e),this.reduce(e)}function montMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function bnpIsEven(){return 0==(0<this.t?1&this[0]:this.s)}function bnpExp(t,e){if(4294967295<t||t<1)return BigInteger.ONE;var r=nbi(),i=nbi(),n=e.convert(this),o=nbits(t)-1;for(n.copyTo(r);0<=--o;)if(e.sqrTo(r,i),0<(t&1<<o))e.mulTo(i,n,r);else{var s=r;r=i,i=s}return e.revert(r)}function bnModPowInt(t,e){var r;return r=t<256||e.isEven()?new Classic(e):new Montgomery(e),this.exp(t,r)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||t<2||36<t)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=nbv(r),n=nbi(),o=nbi(),s="";for(this.divRemTo(i,n,o);0<n.signum();)s=(r+o.intValue()).toString(t).substr(1)+s,n.divRemTo(i,n,o);return o.intValue().toString(t)+s}function bnpFromRadix(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,o=0,s=0,a=0;a<t.length;++a){var h=intAt(t,a);h<0?"-"==t.charAt(a)&&0==this.signum()&&(n=!0):(s=e*s+h,++o>=r&&(this.dMultiply(i),this.dAddOffset(s,0),s=o=0))}0<o&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),n&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,e,r){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var i=new Array,n=7&t;i.length=1+(t>>3),e.nextBytes(i),0<n?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function bnToByteArray(){var t=this.t,e=new Array;e[0]=this.s;var r,i=this.DB-t*this.DB%8,n=0;if(0<t--)for(i<this.DB&&(r=this[t]>>i)!=(this.s&this.DM)>>i&&(e[n++]=r|this.s<<this.DB-i);0<=t;)i<8?(r=(this[t]&(1<<i)-1)<<8-i,r|=this[--t]>>(i+=this.DB-8)):(r=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(0<n||r!=this.s)&&(e[n++]=r);return e}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return 0<this.compareTo(t)?this:t}function bnpBitwiseTo(t,e,r){var i,n,o=Math.min(t.t,this.t);for(i=0;i<o;++i)r[i]=e(this[i],t[i]);if(t.t<this.t){for(n=t.s&this.DM,i=o;i<this.t;++i)r[i]=e(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=o;i<t.t;++i)r[i]=e(n,t[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function op_and(t,e){return t&e}function bnAnd(t){var e=nbi();return this.bitwiseTo(t,op_and,e),e}function op_or(t,e){return t|e}function bnOr(t){var e=nbi();return this.bitwiseTo(t,op_or,e),e}function op_xor(t,e){return t^e}function bnXor(t){var e=nbi();return this.bitwiseTo(t,op_xor,e),e}function op_andnot(t,e){return t&~e}function bnAndNot(t){var e=nbi();return this.bitwiseTo(t,op_andnot,e),e}function bnNot(){for(var t=nbi(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var e=nbi();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bnShiftRight(t){var e=nbi();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function lbit(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bnBitCount(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=cbit(this[r]^e);return t}function bnTestBit(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function bnpChangeBit(t,e){var r=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this[r]+t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t[r],e[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,0<i?e[r++]=i:i<-1&&(e[r++]=this.DV+i),e.t=r,e.clamp()}function bnAdd(t){var e=nbi();return this.addTo(t,e),e}function bnSubtract(t){var e=nbi();return this.subTo(t,e),e}function bnMultiply(t){var e=nbi();return this.multiplyTo(t,e),e}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var e=nbi();return this.divRemTo(t,e,null),e}function bnRemainder(t){var e=nbi();return this.divRemTo(t,null,e),e}function bnDivideAndRemainder(t){var e=nbi(),r=nbi();return this.divRemTo(t,e,r),new Array(e,r)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,e,r){t.multiplyTo(e,r)}function nSqrTo(t,e){t.squareTo(e)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,e,r){var i,n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;0<n;)r[--n]=0;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t[n],r,n,0,e-n);r.clamp()}function bnpMultiplyUpperTo(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;0<=--i;)r[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r[this.t+i-e]=this.am(e-i,t[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=nbi();return t.copyTo(e),this.reduce(e),e}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)}function barrettSqrTo(t,e){t.squareTo(e),this.reduce(e)}function barrettMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function bnModPow(t,e){var r,i,n=t.bitLength(),o=nbv(1);if(n<=0)return o;r=n<18?1:n<48?3:n<144?4:n<768?5:6,i=n<8?new Classic(e):e.isEven()?new Barrett(e):new Montgomery(e);var s=new Array,a=3,h=r-1,u=(1<<r)-1;if(s[1]=i.convert(this),1<r){var g=nbi();for(i.sqrTo(s[1],g);a<=u;)s[a]=nbi(),i.mulTo(g,s[a-2],s[a]),a+=2}var c,f,p=t.t-1,l=!0,d=nbi();for(n=nbits(t[p])-1;0<=p;){for(h<=n?c=t[p]>>n-h&u:(c=(t[p]&(1<<n+1)-1)<<h-n,0<p&&(c|=t[p-1]>>this.DB+n-h)),a=r;0==(1&c);)c>>=1,--a;if((n-=a)<0&&(n+=this.DB,--p),l)s[c].copyTo(o),l=!1;else{for(;1<a;)i.sqrTo(o,d),i.sqrTo(d,o),a-=2;0<a?i.sqrTo(o,d):(f=o,o=d,d=f),i.mulTo(d,s[c],o)}for(;0<=p&&0==(t[p]&1<<n);)i.sqrTo(o,d),f=o,o=d,d=f,--n<0&&(n=this.DB-1,--p)}return i.revert(o)}function bnGCD(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(n<o&&(o=n),0<o&&(e.rShiftTo(o,e),r.rShiftTo(o,r));0<e.signum();)0<(n=e.getLowestSetBit())&&e.rShiftTo(n,e),0<(n=r.getLowestSetBit())&&r.rShiftTo(n,r),0<=e.compareTo(r)?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return 0<o&&r.lShiftTo(o,r),r}function bnpModInt(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(0<this.t)if(0==e)r=this[0]%t;else for(var i=this.t-1;0<=i;--i)r=(e*r+this[i])%t;return r}function bnModInverse(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return BigInteger.ZERO;for(var r=t.clone(),i=this.clone(),n=nbv(1),o=nbv(0),s=nbv(0),a=nbv(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(n.isEven()&&o.isEven()||(n.addTo(this,n),o.subTo(t,o)),n.rShiftTo(1,n)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),e?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);0<=r.compareTo(i)?(r.subTo(i,r),e&&n.subTo(s,n),o.subTo(a,o)):(i.subTo(r,i),e&&s.subTo(n,s),a.subTo(o,a))}return 0!=i.compareTo(BigInteger.ONE)?BigInteger.ZERO:0<=a.compareTo(t)?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(t){var e,r=this.abs();if(1==r.t&&r[0]<=lowprimes[lowprimes.length-1]){for(e=0;e<lowprimes.length;++e)if(r[0]==lowprimes[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<lowprimes.length;){for(var i=lowprimes[e],n=e+1;n<lowprimes.length&&i<lplim;)i*=lowprimes[n++];for(i=r.modInt(i);e<n;)if(i%lowprimes[e++]==0)return!1}return r.millerRabin(t)}function bnpMillerRabin(t){var e=this.subtract(BigInteger.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var i=e.shiftRight(r);(t=t+1>>1)>lowprimes.length&&(t=lowprimes.length);for(var n=nbi(),o=0;o<t;++o){n.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var s=n.modPow(i,this);if(0!=s.compareTo(BigInteger.ONE)&&0!=s.compareTo(e)){for(var a=1;a++<r&&0!=s.compareTo(e);)if(0==(s=s.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=s.compareTo(e))return!1}}return!0}function parseBigInt(t,e){return new BigInteger(t,e)}function linebrk(t,e){for(var r="",i=0;i+e<t.length;)r+=t.substring(i,i+e)+"\n",i+=e;return r+t.substring(i,t.length)}function byte2Hex(t){return t<16?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,e){if(e<t.length+11)return alert("Message too long for RSA"),null;for(var r=new Array,i=t.length-1;0<=i&&0<e;){var n=t.charCodeAt(i--);n<128?r[--e]=n:127<n&&n<2048?(r[--e]=63&n|128,r[--e]=n>>6|192):(r[--e]=63&n|128,r[--e]=n>>6&63|128,r[--e]=n>>12|224)}r[--e]=0;for(var o=new SecureRandom,s=new Array;2<e;){for(s[0]=0;0==s[0];)o.nextBytes(s);r[--e]=s[0]}return r[--e]=2,r[--e]=0,new BigInteger(r)}function oaep_mgf1_arr(t,e,r){for(var i="",n=0;i.length<e;)i+=r(String.fromCharCode.apply(String,t.concat([(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n]))),n+=1;return i}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare;var SHA1_SIZE=20;function oaep_pad(t,e,r){if(t.length+2*SHA1_SIZE+2>e)throw"Message too long for RSA";var i,n="";for(i=0;i<e-t.length-2*SHA1_SIZE-2;i+=1)n+="\0";var o=rstr_sha1("")+n+""+t,s=new Array(SHA1_SIZE);(new SecureRandom).nextBytes(s);var a=oaep_mgf1_arr(s,o.length,r||rstr_sha1),h=[];for(i=0;i<o.length;i+=1)h[i]=o.charCodeAt(i)^a.charCodeAt(i);var u=oaep_mgf1_arr(h,s.length,rstr_sha1),g=[0];for(i=0;i<s.length;i+=1)g[i+1]=s[i]^u.charCodeAt(i);return new BigInteger(g.concat(h))}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(t,e){this.isPublic=!0,"string"!=typeof t?(this.n=t,this.e=e):null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16)):alert("Invalid RSA public key")}function RSADoPublic(t){return t.modPowInt(this.e,this.n)}function RSAEncrypt(t){var e=pkcs1pad2(t,this.n.bitLength()+7>>3);if(null==e)return null;var r=this.doPublic(e);if(null==r)return null;var i=r.toString(16);return 0==(1&i.length)?i:"0"+i}function RSAEncryptOAEP(t,e){var r=oaep_pad(t,this.n.bitLength()+7>>3,e);if(null==r)return null;var i=this.doPublic(r);if(null==i)return null;var n=i.toString(16);return 0==(1&n.length)?n:"0"+n}function pkcs1unpad2(t,e){for(var r=t.toByteArray(),i=0;i<r.length&&0==r[i];)++i;if(r.length-i!=e-1||2!=r[i])return null;for(++i;0!=r[i];)if(++i>=r.length)return null;for(var n="";++i<r.length;){var o=255&r[i];o<128?n+=String.fromCharCode(o):191<o&&o<224?(n+=String.fromCharCode((31&o)<<6|63&r[i+1]),++i):(n+=String.fromCharCode((15&o)<<12|(63&r[i+1])<<6|63&r[i+2]),i+=2)}return n}function oaep_mgf1_str(t,e,r){for(var i="",n=0;i.length<e;)i+=r(t+String.fromCharCode.apply(String,[(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n])),n+=1;return i}RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.encryptOAEP=RSAEncryptOAEP,RSAKey.prototype.type="RSA";SHA1_SIZE=20;function oaep_unpad(t,e,r){for(t=t.toByteArray(),i=0;i<t.length;i+=1)t[i]&=255;for(;t.length<e;)t.unshift(0);if((t=String.fromCharCode.apply(String,t)).length<2*SHA1_SIZE+2)throw"Cipher too short";var i,n=t.substr(1,SHA1_SIZE),o=t.substr(SHA1_SIZE+1),s=oaep_mgf1_str(o,SHA1_SIZE,r||rstr_sha1),a=[];for(i=0;i<n.length;i+=1)a[i]=n.charCodeAt(i)^s.charCodeAt(i);var h=oaep_mgf1_str(String.fromCharCode.apply(String,a),t.length-SHA1_SIZE,rstr_sha1),u=[];for(i=0;i<o.length;i+=1)u[i]=o.charCodeAt(i)^h.charCodeAt(i);if((u=String.fromCharCode.apply(String,u)).substr(0,SHA1_SIZE)!==rstr_sha1(""))throw"Hash mismatch";var g=(u=u.substr(SHA1_SIZE)).indexOf("");if((-1!=g?u.substr(0,g).lastIndexOf("\0"):-1)+1!=g)throw"Malformed data";return u.substr(g+1)}function RSASetPrivate(t,e,r){this.isPrivate=!0,"string"!=typeof t?(this.n=t,this.e=e,this.d=r):null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16),this.d=parseBigInt(r,16)):alert("Invalid RSA private key")}function RSASetPrivateEx(t,e,r,i,n,o,s,a){if(this.isPrivate=!0,null==t)throw"RSASetPrivateEx N == null";if(null==e)throw"RSASetPrivateEx E == null";if(0==t.length)throw"RSASetPrivateEx N.length == 0";if(0==e.length)throw"RSASetPrivateEx E.length == 0";null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16),this.d=parseBigInt(r,16),this.p=parseBigInt(i,16),this.q=parseBigInt(n,16),this.dmp1=parseBigInt(o,16),this.dmq1=parseBigInt(s,16),this.coeff=parseBigInt(a,16)):alert("Invalid RSA private key in RSASetPrivateEx")}function RSAGenerate(t,e){var r=new SecureRandom,i=t>>1;this.e=parseInt(e,16);for(var n=new BigInteger(e,16);;){for(;this.p=new BigInteger(t-i,1,r),0!=this.p.subtract(BigInteger.ONE).gcd(n).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(i,1,r),0!=this.q.subtract(BigInteger.ONE).gcd(n).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var s=this.p.subtract(BigInteger.ONE),a=this.q.subtract(BigInteger.ONE),h=s.multiply(a);if(0==h.gcd(n).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(h),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),r=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(r)<0;)e=e.add(this.p);return e.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)}function RSADecrypt(t){var e=parseBigInt(t,16),r=this.doPrivate(e);return null==r?null:pkcs1unpad2(r,this.n.bitLength()+7>>3)}function RSADecryptOAEP(t,e){var r=parseBigInt(t,16),i=this.doPrivate(r);return null==i?null:oaep_unpad(i,this.n.bitLength()+7>>3,e)}function _rsapem_pemToBase64(t){var e=t;return e=(e=(e=e.replace("-----BEGIN RSA PRIVATE KEY-----","")).replace("-----END RSA PRIVATE KEY-----","")).replace(/[ \n]+/g,"")}function _rsapem_getPosArrayOfChildrenFromHex(t){var e=new Array,r=ASN1HEX.getStartPosOfV_AtObj(t,0),i=ASN1HEX.getPosOfNextSibling_AtObj(t,r),n=ASN1HEX.getPosOfNextSibling_AtObj(t,i),o=ASN1HEX.getPosOfNextSibling_AtObj(t,n),s=ASN1HEX.getPosOfNextSibling_AtObj(t,o),a=ASN1HEX.getPosOfNextSibling_AtObj(t,s),h=ASN1HEX.getPosOfNextSibling_AtObj(t,a),u=ASN1HEX.getPosOfNextSibling_AtObj(t,h),g=ASN1HEX.getPosOfNextSibling_AtObj(t,u);return e.push(r,i,n,o,s,a,h,u,g),e}function _rsapem_getHexValueArrayOfChildrenFromHex(t){var e=_rsapem_getPosArrayOfChildrenFromHex(t),r=ASN1HEX.getHexOfV_AtObj(t,e[0]),i=ASN1HEX.getHexOfV_AtObj(t,e[1]),n=ASN1HEX.getHexOfV_AtObj(t,e[2]),o=ASN1HEX.getHexOfV_AtObj(t,e[3]),s=ASN1HEX.getHexOfV_AtObj(t,e[4]),a=ASN1HEX.getHexOfV_AtObj(t,e[5]),h=ASN1HEX.getHexOfV_AtObj(t,e[6]),u=ASN1HEX.getHexOfV_AtObj(t,e[7]),g=ASN1HEX.getHexOfV_AtObj(t,e[8]),c=new Array;return c.push(r,i,n,o,s,a,h,u,g),c}function _rsapem_readPrivateKeyFromASN1HexString(t){var e=_rsapem_getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function _rsapem_readPrivateKeyFromPEMString(t){var e=_rsapem_getHexValueArrayOfChildrenFromHex(b64tohex(_rsapem_pemToBase64(t)));this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt,RSAKey.prototype.decryptOAEP=RSADecryptOAEP,RSAKey.prototype.readPrivateKeyFromPEMString=_rsapem_readPrivateKeyFromPEMString,RSAKey.prototype.readPrivateKeyFromASN1HexString=_rsapem_readPrivateKeyFromASN1HexString;var _RE_HEXDECONLY=new RegExp("");function _rsasign_getHexPaddedDigestInfoForString(t,e,r){var i,n=(i=t,KJUR.crypto.Util.hashString(i,r));return KJUR.crypto.Util.getPaddedDigestInfoHex(n,r,e)}function _zeroPaddingOfSignature(t,e){for(var r="",i=e/4-t.length,n=0;n<i;n++)r+="0";return r+t}function _rsasign_signString(t,e){var r,i=(r=t,KJUR.crypto.Util.hashString(r,e));return this.signWithMessageHash(i,e)}function _rsasign_signWithMessageHash(t,e){var r=parseBigInt(KJUR.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return _zeroPaddingOfSignature(this.doPrivate(r).toString(16),this.n.bitLength())}function _rsasign_signStringWithSHA1(t){return _rsasign_signString.call(this,t,"sha1")}function _rsasign_signStringWithSHA256(t){return _rsasign_signString.call(this,t,"sha256")}function pss_mgf1_str(t,e,r){for(var i="",n=0;i.length<e;)i+=hextorstr(r(rstrtohex(t+String.fromCharCode.apply(String,[(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n])))),n+=1;return i}function _rsasign_signStringPSS(t,e,r){var i,n=(i=rstrtohex(t),KJUR.crypto.Util.hashHex(i,e));return void 0===r&&(r=-1),this.signWithMessageHashPSS(n,e,r)}function _rsasign_signWithMessageHashPSS(t,e,r){var i,n=hextorstr(t),o=n.length,s=this.n.bitLength()-1,a=Math.ceil(s/8),h=function(t){return KJUR.crypto.Util.hashHex(t,e)};if(-1===r||void 0===r)r=o;else if(-2===r)r=a-o-2;else if(r<-2)throw"invalid salt length";if(a<o+r+2)throw"data too long";var u="";0<r&&(u=new Array(r),(new SecureRandom).nextBytes(u),u=String.fromCharCode.apply(String,u));var g=hextorstr(h(rstrtohex("\0\0\0\0\0\0\0\0"+n+u))),c=[];for(i=0;i<a-r-o-2;i+=1)c[i]=0;var f=String.fromCharCode.apply(String,c)+""+u,p=pss_mgf1_str(g,f.length,h),l=[];for(i=0;i<f.length;i+=1)l[i]=f.charCodeAt(i)^p.charCodeAt(i);var d=65280>>8*a-s&255;for(l[0]&=~d,i=0;i<o;i++)l.push(g.charCodeAt(i));return l.push(188),_zeroPaddingOfSignature(this.doPrivate(new BigInteger(l)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(t,e,r){var i=new RSAKey;return i.setPublic(e,r),i.doPublic(t)}function _rsasign_getHexDigestInfoFromSig(t,e,r){return _rsasign_getDecryptSignatureBI(t,e,r).toString(16).replace(/^1f+00/,"")}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(t){for(var e in KJUR.crypto.Util.DIGESTINFOHEAD){var r=KJUR.crypto.Util.DIGESTINFOHEAD[e],i=r.length;if(t.substring(0,i)==r)return[e,t.substring(i)]}return[]}function _rsasign_verifySignatureWithArgs(t,e,r,i){var n=_rsasign_getAlgNameAndHashFromHexDisgestInfo(_rsasign_getHexDigestInfoFromSig(e,r,i));if(0==n.length)return!1;var o,s=n[0];return n[1]==(o=t,KJUR.crypto.Util.hashString(o,s))}function _rsasign_verifyHexSignatureForMessage(t,e){return _rsasign_verifySignatureWithArgs(e,parseBigInt(t,16),this.n.toString(16),this.e.toString(16))}function _rsasign_verifyString(t,e){var r=parseBigInt(e=(e=e.replace(_RE_HEXDECONLY,"")).replace(/[ \n]+/g,""),16);if(r.bitLength()>this.n.bitLength())return 0;var i=_rsasign_getAlgNameAndHashFromHexDisgestInfo(this.doPublic(r).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;var n,o=i[0];return i[1]==(n=t,KJUR.crypto.Util.hashString(n,o))}function _rsasign_verifyWithMessageHash(t,e){var r=parseBigInt(e=(e=e.replace(_RE_HEXDECONLY,"")).replace(/[ \n]+/g,""),16);if(r.bitLength()>this.n.bitLength())return 0;var i=_rsasign_getAlgNameAndHashFromHexDisgestInfo(this.doPublic(r).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;i[0];return i[1]==t}function _rsasign_verifyStringPSS(t,e,r,i){var n,o=(n=rstrtohex(t),KJUR.crypto.Util.hashHex(n,r));return void 0===i&&(i=-1),this.verifyWithMessageHashPSS(o,e,r,i)}function _rsasign_verifyWithMessageHashPSS(t,e,r,i){var n=new BigInteger(e,16);if(n.bitLength()>this.n.bitLength())return!1;var o,s=function(t){return KJUR.crypto.Util.hashHex(t,r)},a=hextorstr(t),h=a.length,u=this.n.bitLength()-1,g=Math.ceil(u/8);if(-1===i||void 0===i)i=h;else if(-2===i)i=g-h-2;else if(i<-2)throw"invalid salt length";if(g<h+i+2)throw"data too long";var c=this.doPublic(n).toByteArray();for(o=0;o<c.length;o+=1)c[o]&=255;for(;c.length<g;)c.unshift(0);if(188!==c[g-1])throw"encoded message does not end in 0xbc";var f=(c=String.fromCharCode.apply(String,c)).substr(0,g-h-1),p=c.substr(f.length,h),l=65280>>8*g-u&255;if(0!=(f.charCodeAt(0)&l))throw"bits beyond keysize not zero";var d=pss_mgf1_str(p,f.length,s),S=[];for(o=0;o<f.length;o+=1)S[o]=f.charCodeAt(o)^d.charCodeAt(o);S[0]&=~l;var y=g-h-i-2;for(o=0;o<y;o+=1)if(0!==S[o])throw"leftmost octets not zero";if(1!==S[y])throw"0x01 marker not found";return p===hextorstr(s(rstrtohex("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,S.slice(-i)))))}_RE_HEXDECONLY.compile("[^0-9a-f]","gi"),RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash,RSAKey.prototype.signString=_rsasign_signString,RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.sign=_rsasign_signString,RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS,RSAKey.prototype.signStringPSS=_rsasign_signStringPSS,RSAKey.prototype.signPSS=_rsasign_signStringPSS,RSAKey.SALT_LEN_HLEN=-1,RSAKey.SALT_LEN_MAX=-2,RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash,RSAKey.prototype.verifyString=_rsasign_verifyString,RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage,RSAKey.prototype.verify=_rsasign_verifyString,RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage,RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS,RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS,RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS,RSAKey.SALT_LEN_RECOVER=-2;var KJUR,utf8tob64u,b64utoutf8,ASN1HEX=new function(){};function X509(){this.subjectPublicKeyRSA=null,this.subjectPublicKeyRSA_hN=null,this.subjectPublicKeyRSA_hE=null,this.hex=null,this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])},this.getSignatureAlgorithmField=function(){var t=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,2,0]),e=KJUR.asn1.ASN1Util.oidHexToInt(t);return KJUR.asn1.x509.OID.oid2name(e)},this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])},this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))},this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])},this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))},this.getNotBefore=function(){var t=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getNotAfter=function(){var t=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.readCertPEM=function(t){var e=X509.pemToHex(t),r=X509.getPublicKeyHexArrayFromCertHex(e),i=new RSAKey;i.setPublic(r[0],r[1]),this.subjectPublicKeyRSA=i,this.subjectPublicKeyRSA_hN=r[0],this.subjectPublicKeyRSA_hE=r[1],this.hex=e},this.readCertPEMWithoutRSAInit=function(t){var e=X509.pemToHex(t),r=X509.getPublicKeyHexArrayFromCertHex(e);"function"==typeof this.subjectPublicKeyRSA.setPublic&&this.subjectPublicKeyRSA.setPublic(r[0],r[1]),this.subjectPublicKeyRSA_hN=r[0],this.subjectPublicKeyRSA_hE=r[1],this.hex=e},this.getInfo=function(){var t="Basic Fields\n";t+=" serial number: "+this.getSerialNumberHex()+"\n",t+=" signature algorithm: "+this.getSignatureAlgorithmField()+"\n",t+=" issuer: "+this.getIssuerString()+"\n",t+=" notBefore: "+this.getNotBefore()+"\n",t+=" notAfter: "+this.getNotAfter()+"\n",t+=" subject: "+this.getSubjectString()+"\n",t+=" subject public key info: \n";var e=X509.getSubjectPublicKeyInfoPosFromCertHex(this.hex),r=ASN1HEX.getHexOfTLV_AtObj(this.hex,e),i=KEYUTIL.getKey(r,null,"pkcs8pub");i instanceof RSAKey&&(t+=" key algorithm: RSA\n",t+=" n="+i.n.toString(16).substr(0,16)+"...\n",t+=" e="+i.e.toString(16)+"\n"),t+="X509v3 Extensions:\n";for(var n=X509.getV3ExtInfoListOfCertHex(this.hex),o=0;o<n.length;o++){var s=n[o],a=KJUR.asn1.x509.OID.oid2name(s.oid);""===a&&(a=s.oid);var h="";if(!0===s.critical&&(h="CRITICAL"),t+=" "+a+" "+h+":\n","basicConstraints"===a){var u=X509.getExtBasicConstraints(this.hex);void 0===u.cA?t+=" {}\n":(t+=" cA=true",void 0!==u.pathLen&&(t+=", pathLen="+u.pathLen),t+="\n")}else if("keyUsage"===a)t+=" "+X509.getExtKeyUsageString(this.hex)+"\n";else if("subjectKeyIdentifier"===a)t+=" "+X509.getExtSubjectKeyIdentifier(this.hex)+"\n";else if("authorityKeyIdentifier"===a){var g=X509.getExtAuthorityKeyIdentifier(this.hex);void 0!==g.kid&&(t+=" kid="+g.kid+"\n")}else if("extKeyUsage"===a){t+=" "+X509.getExtExtKeyUsageName(this.hex).join(", ")+"\n"}else if("subjectAltName"===a){t+=" "+X509.getExtSubjectAltName(this.hex).join(", ")+"\n"}else if("cRLDistributionPoints"===a){t+=" "+X509.getExtCRLDistributionPointsURI(this.hex)+"\n"}else if("authorityInfoAccess"===a){var c=X509.getExtAIAInfo(this.hex);void 0!==c.ocsp&&(t+=" ocsp: "+c.ocsp.join(",")+"\n"),void 0!==c.caissuer&&(t+=" caissuer: "+c.caissuer.join(",")+"\n")}}return t+="signature algorithm: "+X509.getSignatureAlgorithmName(this.hex)+"\n",t+="signature: "+X509.getSignatureValueHex(this.hex).substr(0,16)+"...\n"}}function Base64x(){}function stoBA(t){for(var e=new Array,r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function BAtos(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}function BAtohex(t){for(var e="",r=0;r<t.length;r++){var i=t[r].toString(16);1==i.length&&(i="0"+i),e+=i}return e}function stohex(t){return BAtohex(stoBA(t))}function stob64(t){return hex2b64(stohex(t))}function stob64u(t){return b64tob64u(hex2b64(stohex(t)))}function b64utos(t){return BAtos(b64toBA(b64utob64(t)))}function b64tob64u(t){return t=(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function b64utob64(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function hextob64u(t){return t.length%2==1&&(t="0"+t),b64tob64u(hex2b64(t))}function b64utohex(t){return b64tohex(b64utob64(t))}function utf8tob64(t){return hex2b64(uricmptohex(encodeURIComponentAll(t)))}function b64toutf8(t){return decodeURIComponent(hextouricmp(b64tohex(t)))}function utf8tohex(t){return uricmptohex(encodeURIComponentAll(t))}function hextoutf8(t){return decodeURIComponent(hextouricmp(t))}function hextorstr(t){for(var e="",r=0;r<t.length-1;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e}function rstrtohex(t){for(var e="",r=0;r<t.length;r++)e+=("0"+t.charCodeAt(r).toString(16)).slice(-2);return e}function hextob64(t){return hex2b64(t)}function hextob64nl(t){var e=hextob64(t).replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,"")}function b64nltohex(t){return b64tohex(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}function hextoArrayBuffer(t){if(t.length%2!=0)throw"input is not even length";if(null==t.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var e=new ArrayBuffer(t.length/2),r=new DataView(e),i=0;i<t.length/2;i++)r.setUint8(i,parseInt(t.substr(2*i,2),16));return e}function ArrayBuffertohex(t){for(var e="",r=new DataView(t),i=0;i<t.byteLength;i++)e+=("00"+r.getUint8(i).toString(16)).slice(-2);return e}function uricmptohex(t){return t.replace(/%/g,"")}function hextouricmp(t){return t.replace(/(..)/g,"%$1")}function encodeURIComponentAll(t){for(var e=encodeURIComponent(t),r="",i=0;i<e.length;i++)"%"==e[i]?(r+=e.substr(i,3),i+=2):r=r+"%"+stohex(e[i]);return r}function newline_toUnix(t){return t=t.replace(/\r\n/gm,"\n")}function newline_toDos(t){return t=(t=t.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")}function intarystrtohex(t){t=(t=(t=t.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return t.split(/,/).map(function(t,e,r){var i=parseInt(t);if(i<0||255<i)throw"integer not in range 0-255";return("00"+i.toString(16)).slice(-2)}).join("")}catch(t){throw"malformed integer array string: "+t}}ASN1HEX.getByteLengthOfL_AtObj=function(t,e){if("8"!=t.substring(e+2,e+3))return 1;var r=parseInt(t.substring(e+3,e+4));return 0==r?-1:0<r&&r<10?r+1:-2},ASN1HEX.getHexOfL_AtObj=function(t,e){var r=ASN1HEX.getByteLengthOfL_AtObj(t,e);return r<1?"":t.substring(e+2,e+2+2*r)},ASN1HEX.getIntOfL_AtObj=function(t,e){var r=ASN1HEX.getHexOfL_AtObj(t,e);return""==r?-1:(parseInt(r.substring(0,1))<8?new BigInteger(r,16):new BigInteger(r.substring(2),16)).intValue()},ASN1HEX.getStartPosOfV_AtObj=function(t,e){var r=ASN1HEX.getByteLengthOfL_AtObj(t,e);return r<0?r:e+2*(r+1)},ASN1HEX.getHexOfV_AtObj=function(t,e){var r=ASN1HEX.getStartPosOfV_AtObj(t,e),i=ASN1HEX.getIntOfL_AtObj(t,e);return t.substring(r,r+2*i)},ASN1HEX.getHexOfTLV_AtObj=function(t,e){return t.substr(e,2)+ASN1HEX.getHexOfL_AtObj(t,e)+ASN1HEX.getHexOfV_AtObj(t,e)},ASN1HEX.getPosOfNextSibling_AtObj=function(t,e){return ASN1HEX.getStartPosOfV_AtObj(t,e)+2*ASN1HEX.getIntOfL_AtObj(t,e)},ASN1HEX.getPosArrayOfChildren_AtObj=function(t,e){var r=new Array,i=ASN1HEX.getStartPosOfV_AtObj(t,e);"03"==t.substr(e,2)?r.push(i+2):r.push(i);for(var n=ASN1HEX.getIntOfL_AtObj(t,e),o=i,s=0;;){var a=ASN1HEX.getPosOfNextSibling_AtObj(t,o);if(null==a||2*n<=a-i)break;if(200<=s)break;r.push(a),o=a,s++}return r},ASN1HEX.getNthChildIndex_AtObj=function(t,e,r){return ASN1HEX.getPosArrayOfChildren_AtObj(t,e)[r]},ASN1HEX.getDecendantIndexByNthList=function(t,e,r){if(0==r.length)return e;var i=r.shift(),n=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);return ASN1HEX.getDecendantIndexByNthList(t,n[i],r)},ASN1HEX.getDecendantHexTLVByNthList=function(t,e,r){var i=ASN1HEX.getDecendantIndexByNthList(t,e,r);return ASN1HEX.getHexOfTLV_AtObj(t,i)},ASN1HEX.getDecendantHexVByNthList=function(t,e,r){var i=ASN1HEX.getDecendantIndexByNthList(t,e,r);return ASN1HEX.getHexOfV_AtObj(t,i)},ASN1HEX.getVbyList=function(t,e,r,i){var n=ASN1HEX.getDecendantIndexByNthList(t,e,r);if(void 0===n)throw"can't find nthList object";if(void 0!==i&&t.substr(n,2)!=i)throw"checking tag doesn't match: "+t.substr(n,2)+"!="+i;return ASN1HEX.getHexOfV_AtObj(t,n)},ASN1HEX.hextooidstr=function(t){var e=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},r=[],i=t.substr(0,2),n=parseInt(i,16);r[0]=new String(Math.floor(n/40)),r[1]=new String(n%40);for(var o=t.substr(2),s=[],a=0;a<o.length/2;a++)s.push(parseInt(o.substr(2*a,2),16));var h=[],u="";for(a=0;a<s.length;a++)128&s[a]?u+=e((127&s[a]).toString(2),7):(u+=e((127&s[a]).toString(2),7),h.push(new String(parseInt(u,2))),u="");var g=r.join(".");return 0<h.length&&(g=g+"."+h.join(".")),g},ASN1HEX.dump=function(t,e,r,i){var n=t;t instanceof KJUR.asn1.ASN1Object&&(n=t.getEncodedHex());var o=function(t,e){return t.length<=2*e?t:t.substr(0,e)+"..(total "+t.length/2+"bytes).."+t.substr(t.length-e,e)};void 0===e&&(e={ommit_long_octet:32}),void 0===r&&(r=0),void 0===i&&(i="");var s=e.ommit_long_octet;if("01"==n.substr(r,2))return"00"==(a=ASN1HEX.getHexOfV_AtObj(n,r))?i+"BOOLEAN FALSE\n":i+"BOOLEAN TRUE\n";if("02"==n.substr(r,2))return i+"INTEGER "+o(a=ASN1HEX.getHexOfV_AtObj(n,r),s)+"\n";if("03"==n.substr(r,2))return i+"BITSTRING "+o(a=ASN1HEX.getHexOfV_AtObj(n,r),s)+"\n";if("04"==n.substr(r,2)){var a=ASN1HEX.getHexOfV_AtObj(n,r);return ASN1HEX.isASN1HEX(a)?(f=i+"OCTETSTRING, encapsulates\n")+ASN1HEX.dump(a,e,0,i+"  "):i+"OCTETSTRING "+o(a,s)+"\n"}if("05"==n.substr(r,2))return i+"NULL\n";if("06"==n.substr(r,2)){var h=ASN1HEX.getHexOfV_AtObj(n,r),u=KJUR.asn1.ASN1Util.oidHexToInt(h),g=KJUR.asn1.x509.OID.oid2name(u),c=u.replace(/\./g," ");return""!=g?i+"ObjectIdentifier "+g+" ("+c+")\n":i+"ObjectIdentifier ("+c+")\n"}if("0c"==n.substr(r,2))return i+"UTF8String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(n,r))+"'\n";if("13"==n.substr(r,2))return i+"PrintableString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(n,r))+"'\n";if("14"==n.substr(r,2))return i+"TeletexString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(n,r))+"'\n";if("16"==n.substr(r,2))return i+"IA5String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(n,r))+"'\n";if("17"==n.substr(r,2))return i+"UTCTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(n,r))+"\n";if("18"==n.substr(r,2))return i+"GeneralizedTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(n,r))+"\n";if("30"==n.substr(r,2)){if("3000"==n.substr(r,4))return i+"SEQUENCE {}\n";var f=i+"SEQUENCE\n",p=e;if((2==(y=ASN1HEX.getPosArrayOfChildren_AtObj(n,r)).length||3==y.length)&&"06"==n.substr(y[0],2)&&"04"==n.substr(y[y.length-1],2)){var l=ASN1HEX.getHexOfV_AtObj(n,y[0]),d=(u=KJUR.asn1.ASN1Util.oidHexToInt(l),g=KJUR.asn1.x509.OID.oid2name(u),JSON.parse(JSON.stringify(e)));d.x509ExtName=g,p=d}for(var S=0;S<y.length;S++)f+=ASN1HEX.dump(n,p,y[S],i+"  ");return f}if("31"==n.substr(r,2)){f=i+"SET\n";var y=ASN1HEX.getPosArrayOfChildren_AtObj(n,r);for(S=0;S<y.length;S++)f+=ASN1HEX.dump(n,e,y[S],i+"  ");return f}var v=parseInt(n.substr(r,2),16);if(0!=(128&v)){var A=31&v;if(0!=(32&v)){var f=i+"["+A+"]\n";for(y=ASN1HEX.getPosArrayOfChildren_AtObj(n,r),S=0;S<y.length;S++)f+=ASN1HEX.dump(n,e,y[S],i+"  ");return f}return"68747470"==(a=ASN1HEX.getHexOfV_AtObj(n,r)).substr(0,8)&&(a=hextoutf8(a)),"subjectAltName"===e.x509ExtName&&2==A&&(a=hextoutf8(a)),f=i+"["+A+"] "+a+"\n"}return i+"UNKNOWN("+n.substr(r,2)+") "+ASN1HEX.getHexOfV_AtObj(n,r)+"\n"},ASN1HEX.isASN1HEX=function(t){if(t.length%2==1)return!1;var e=ASN1HEX.getIntOfL_AtObj(t,0),r=t.substr(0,2),i=ASN1HEX.getHexOfL_AtObj(t,0);return t.length-r.length-i.length==2*e},X509.pemToBase64=function(t){var e=t;return e=(e=(e=e.replace("-----BEGIN CERTIFICATE-----","")).replace("-----END CERTIFICATE-----","")).replace(/[ \n]+/g,"")},X509.pemToHex=function(t){return b64tohex(X509.pemToBase64(t))},X509.getSubjectPublicKeyPosFromCertHex=function(t){var e=X509.getSubjectPublicKeyInfoPosFromCertHex(t);if(-1==e)return-1;var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);if(2!=r.length)return-1;var i=r[1];if("03"!=t.substring(i,i+2))return-1;var n=ASN1HEX.getStartPosOfV_AtObj(t,i);return"00"!=t.substring(n,n+2)?-1:n+2},X509.getSubjectPublicKeyInfoPosFromCertHex=function(t){var e=ASN1HEX.getStartPosOfV_AtObj(t,0),r=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);return r.length<1?-1:"a003020102"==t.substring(r[0],r[0]+10)?r.length<6?-1:r[6]:r.length<5?-1:r[5]},X509.getPublicKeyHexArrayFromCertHex=function(t){var e=X509.getSubjectPublicKeyPosFromCertHex(t),r=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);if(2!=r.length)return[];var i=ASN1HEX.getHexOfV_AtObj(t,r[0]),n=ASN1HEX.getHexOfV_AtObj(t,r[1]);return null!=i&&null!=n?[i,n]:[]},X509.getHexTbsCertificateFromCert=function(t){return ASN1HEX.getStartPosOfV_AtObj(t,0)},X509.getPublicKeyHexArrayFromCertPEM=function(t){var e=X509.pemToHex(t);return X509.getPublicKeyHexArrayFromCertHex(e)},X509.hex2dn=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed DN";for(var r=new Array,i=ASN1HEX.getPosArrayOfChildren_AtObj(t,e),n=0;n<i.length;n++)r.push(X509.hex2rdn(t,i[n]));return"/"+(r=r.map(function(t){return t.replace("/","\\/")})).join("/")},X509.hex2rdn=function(t,e){if(void 0===e&&(e=0),"31"!==t.substr(e,2))throw"malformed RDN";for(var r=new Array,i=ASN1HEX.getPosArrayOfChildren_AtObj(t,e),n=0;n<i.length;n++)r.push(X509.hex2attrTypeValue(t,i[n]));return(r=r.map(function(t){return t.replace("+","\\+")})).join("+")},X509.hex2attrTypeValue=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed attribute type and value";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);2!==r.length||t.substr(r[0],2);var i=ASN1HEX.getHexOfV_AtObj(t,r[0]),n=KJUR.asn1.ASN1Util.oidHexToInt(i);return KJUR.asn1.x509.OID.oid2atype(n)+"="+hextorstr(ASN1HEX.getHexOfV_AtObj(t,r[1]))},X509.getPublicKeyFromCertPEM=function(t){var e=X509.getPublicKeyInfoPropOfCertPEM(t);if("2a864886f70d010101"==e.algoid){var r=KEYUTIL.parsePublicRawRSAKeyHex(e.keyhex);return(n=new RSAKey).setPublic(r.n,r.e),n}if("2a8648ce3d0201"==e.algoid){var i=KJUR.crypto.OID.oidhex2name[e.algparam];return(n=new KJUR.crypto.ECDSA({curve:i,info:e.keyhex})).setPublicKeyHex(e.keyhex),n}if("2a8648ce380401"==e.algoid){var n,o=ASN1HEX.getVbyList(e.algparam,0,[0],"02"),s=ASN1HEX.getVbyList(e.algparam,0,[1],"02"),a=ASN1HEX.getVbyList(e.algparam,0,[2],"02"),h=ASN1HEX.getHexOfV_AtObj(e.keyhex,0);return h=h.substr(2),(n=new KJUR.crypto.DSA).setPublic(new BigInteger(o,16),new BigInteger(s,16),new BigInteger(a,16),new BigInteger(h,16)),n}throw"unsupported key"},X509.getPublicKeyInfoPropOfCertPEM=function(t){var e={algparam:null},r=X509.pemToHex(t),i=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(3!=i.length)throw"malformed X.509 certificate PEM (code:001)";if("30"!=r.substr(i[0],2))throw"malformed X.509 certificate PEM (code:002)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(r,i[0]),o=6;if("a0"!==r.substr(n[0],2)&&(o=5),n.length<o+1)throw"malformed X.509 certificate PEM (code:003)";var s=ASN1HEX.getPosArrayOfChildren_AtObj(r,n[o]);if(2!=s.length)throw"malformed X.509 certificate PEM (code:004)";var a=ASN1HEX.getPosArrayOfChildren_AtObj(r,s[0]);if(2!=a.length)throw"malformed X.509 certificate PEM (code:005)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(r,a[0]),"06"==r.substr(a[1],2)?e.algparam=ASN1HEX.getHexOfV_AtObj(r,a[1]):"30"==r.substr(a[1],2)&&(e.algparam=ASN1HEX.getHexOfTLV_AtObj(r,a[1])),"03"!=r.substr(s[1],2))throw"malformed X.509 certificate PEM (code:006)";var h=ASN1HEX.getHexOfV_AtObj(r,s[1]);return e.keyhex=h.substr(2),e},X509.getPublicKeyInfoPosOfCertHEX=function(t){var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(3!=e.length)throw"malformed X.509 certificate PEM (code:001)";if("30"!=t.substr(e[0],2))throw"malformed X.509 certificate PEM (code:002)";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,e[0]);if(r.length<7)throw"malformed X.509 certificate PEM (code:003)";return r[6]},X509.getV3ExtInfoListOfCertHex=function(t){var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(3!=e.length)throw"malformed X.509 certificate PEM (code:001)";if("30"!=t.substr(e[0],2))throw"malformed X.509 certificate PEM (code:002)";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,e[0]);if(r.length<8)throw"malformed X.509 certificate PEM (code:003)";if("a3"!=t.substr(r[7],2))throw"malformed X.509 certificate PEM (code:004)";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,r[7]);if(1!=i.length)throw"malformed X.509 certificate PEM (code:005)";if("30"!=t.substr(i[0],2))throw"malformed X.509 certificate PEM (code:006)";for(var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,i[0]),o=n.length,s=new Array(o),a=0;a<o;a++)s[a]=X509.getV3ExtItemInfo_AtObj(t,n[a]);return s},X509.getV3ExtItemInfo_AtObj=function(t,e){var r={};r.posTLV=e;var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);if(2!=i.length&&3!=i.length)throw"malformed X.509v3 Ext (code:001)";if("06"!=t.substr(i[0],2))throw"malformed X.509v3 Ext (code:002)";var n=ASN1HEX.getHexOfV_AtObj(t,i[0]);r.oid=ASN1HEX.hextooidstr(n),r.critical=!1,3==i.length&&(r.critical=!0);var o=i[i.length-1];if("04"!=t.substr(o,2))throw"malformed X.509v3 Ext (code:003)";return r.posV=ASN1HEX.getStartPosOfV_AtObj(t,o),r},X509.getHexOfTLV_V3ExtValue=function(t,e){var r=X509.getPosOfTLV_V3ExtValue(t,e);return-1==r?null:ASN1HEX.getHexOfTLV_AtObj(t,r)},X509.getHexOfV_V3ExtValue=function(t,e){var r=X509.getPosOfTLV_V3ExtValue(t,e);return-1==r?null:ASN1HEX.getHexOfV_AtObj(t,r)},X509.getPosOfTLV_V3ExtValue=function(t,e){var r=e;if(e.match(/^[0-9.]+$/)||(r=KJUR.asn1.x509.OID.name2oid(e)),""==r)return-1;for(var i=X509.getV3ExtInfoListOfCertHex(t),n=0;n<i.length;n++){var o=i[n];if(o.oid==r)return o.posV}return-1},X509.getExtBasicConstraints=function(t){var e=X509.getHexOfV_V3ExtValue(t,"basicConstraints");if(null===e)return null;if(""===e)return{};if("0101ff"===e)return{cA:!0};if("0101ff02"===e.substr(0,8)){var r=ASN1HEX.getHexOfV_AtObj(e,6);return{cA:!0,pathLen:parseInt(r,16)}}throw"unknown error"},X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],X509.getExtKeyUsageBin=function(t){var e=X509.getHexOfV_V3ExtValue(t,"keyUsage");if(""==e)return"";if(e.length%2!=0||e.length<=2)throw"malformed key usage value";var r=parseInt(e.substr(0,2)),i=parseInt(e.substr(2),16).toString(2);return i.substr(0,i.length-r)},X509.getExtKeyUsageString=function(t){for(var e=X509.getExtKeyUsageBin(t),r=new Array,i=0;i<e.length;i++)"1"==e.substr(i,1)&&r.push(X509.KEYUSAGE_NAME[i]);return r.join(",")},X509.getExtSubjectKeyIdentifier=function(t){return X509.getHexOfV_V3ExtValue(t,"subjectKeyIdentifier")},X509.getExtAuthorityKeyIdentifier=function(t){var e={},r=X509.getHexOfTLV_V3ExtValue(t,"authorityKeyIdentifier");if(null===r)return null;for(var i=ASN1HEX.getPosArrayOfChildren_AtObj(r,0),n=0;n<i.length;n++)"80"===r.substr(i[n],2)&&(e.kid=ASN1HEX.getHexOfV_AtObj(r,i[n]));return e},X509.getExtExtKeyUsageName=function(t){var e=new Array,r=X509.getHexOfTLV_V3ExtValue(t,"extKeyUsage");if(null===r)return null;for(var i=ASN1HEX.getPosArrayOfChildren_AtObj(r,0),n=0;n<i.length;n++){var o=ASN1HEX.getHexOfV_AtObj(r,i[n]),s=KJUR.asn1.ASN1Util.oidHexToInt(o),a=KJUR.asn1.x509.OID.oid2name(s);e.push(a)}return e},X509.getExtSubjectAltName=function(t){for(var e=new Array,r=X509.getHexOfTLV_V3ExtValue(t,"subjectAltName"),i=ASN1HEX.getPosArrayOfChildren_AtObj(r,0),n=0;n<i.length;n++)if("82"===r.substr(i[n],2)){var o=hextoutf8(ASN1HEX.getHexOfV_AtObj(r,i[n]));e.push(o)}return e},X509.getExtCRLDistributionPointsURI=function(t){for(var e=new Array,r=X509.getHexOfTLV_V3ExtValue(t,"cRLDistributionPoints"),i=ASN1HEX.getPosArrayOfChildren_AtObj(r,0),n=0;n<i.length;n++)for(var o=ASN1HEX.getHexOfTLV_AtObj(r,i[n]),s=ASN1HEX.getPosArrayOfChildren_AtObj(o,0),a=0;a<s.length;a++)if("a0"===o.substr(s[a],2)){var h=ASN1HEX.getHexOfV_AtObj(o,s[a]);if("a0"===h.substr(0,2)){var u=ASN1HEX.getHexOfV_AtObj(h,0);if("86"===u.substr(0,2)){var g=hextoutf8(ASN1HEX.getHexOfV_AtObj(u,0));e.push(g)}}}return e},X509.getExtAIAInfo=function(t){var e={ocsp:[],caissuer:[]},r=X509.getPosOfTLV_V3ExtValue(t,"authorityInfoAccess");if(-1==r)return null;if("30"!=t.substr(r,2))throw"malformed AIA Extn Value";for(var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,r),n=0;n<i.length;n++){var o=i[n],s=ASN1HEX.getPosArrayOfChildren_AtObj(t,o);if(2!=s.length)throw"malformed AccessDescription of AIA Extn";var a=s[0],h=s[1];"2b06010505073001"==ASN1HEX.getHexOfV_AtObj(t,a)&&"86"==t.substr(h,2)&&e.ocsp.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(t,h))),"2b06010505073002"==ASN1HEX.getHexOfV_AtObj(t,a)&&"86"==t.substr(h,2)&&e.caissuer.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(t,h)))}return e},X509.getSignatureAlgorithmName=function(t){var e=ASN1HEX.getDecendantHexVByNthList(t,0,[1,0]),r=KJUR.asn1.ASN1Util.oidHexToInt(e);return KJUR.asn1.x509.OID.oid2name(r)},X509.getSignatureValueHex=function(t){var e=ASN1HEX.getDecendantHexVByNthList(t,0,[2]);if("00"!==e.substr(0,2))throw"can't get signature value";return e.substr(2)},X509.getSerialNumberHex=function(t){return ASN1HEX.getDecendantHexVByNthList(t,0,[0,1])},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:CryptoJS.algo.MD5,sha1:CryptoJS.algo.SHA1,sha224:CryptoJS.algo.SHA224,sha256:CryptoJS.algo.SHA256,sha384:CryptoJS.algo.SHA384,sha512:CryptoJS.algo.SHA512,ripemd160:CryptoJS.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,r){var i=this.getDigestInfoHex(t,e),n=r/4;if(i.length+22>n)throw"key is too short for SigAlg: keylen="+r+","+e;for(var o="00"+i,s="",a=n-"0001".length-o.length,h=0;h<a;h+=2)s+="ff";return"0001"+s+o},this.hashString=function(t,e){return new KJUR.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new KJUR.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)}},KJUR.crypto.Util.md5=function(t){return new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},KJUR.crypto.Util.ripemd160=function(t){return new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},KJUR.crypto.Util.SECURERANDOMGEN=new SecureRandom,KJUR.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return KJUR.crypto.Util.SECURERANDOMGEN.nextBytes(e),BAtohex(e)},KJUR.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new BigInteger(KJUR.crypto.Util.getRandomHexOfNbytes(t),16)},KJUR.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,r=new Array((t-e)/8+1);return KJUR.crypto.Util.SECURERANDOMGEN.nextBytes(r),r[0]=(255<<e&255^255)&r[0],BAtohex(r)},KJUR.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new BigInteger(KJUR.crypto.Util.getRandomHexOfNbits(t),16)},KJUR.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var r=KJUR.crypto.Util.getRandomBigIntegerOfNbits(e);if(-1!=t.compareTo(r))return r}},KJUR.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var r=t.compareTo(e);if(1==r)throw"biMin is greater than biMax";if(0==r)return t;var i=e.subtract(t);return KJUR.crypto.Util.getRandomBigIntegerZeroToMax(i).add(t)},KJUR.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(null!==(t=KJUR.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=KJUR.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=CryptoJS.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(CryptoJS.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},KJUR.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},KJUR.crypto.MessageDigest.getHashLength=function(t){var e=KJUR.crypto.MessageDigest,r=e.getCanonicalAlgName(t);if(void 0===e.HASHLENGTH[r])throw"not supported algorithm: "+t;return e.HASHLENGTH[r]},KJUR.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},KJUR.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=KJUR.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var r=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)&&"cryptojs"==e){try{var i=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=CryptoJS.algo.HMAC.create(i,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=CryptoJS.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(CryptoJS.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=rstrtohex(t)),void(this.pass=CryptoJS.enc.Hex.parse(e))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;e=null;if(void 0!==t.hex){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=utf8tohex(t.utf8)),void 0!==t.rstr&&(e=rstrtohex(t.rstr)),void 0!==t.b64&&(e=b64tohex(t.b64)),void 0!==t.b64u&&(e=b64utohex(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=CryptoJS.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},KJUR.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var r="",i=e/4-t.length,n=0;n<i;n++)r+="0";return r+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var r=null;try{r=void 0===e?KEYUTIL.getKey(t):KEYUTIL.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===r.isPrivate)this.prvKey=r,this.state="SIGN";else{if(!0!==r.isPublic)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.initSign=function(t){"string"==typeof t.ecprvhex&&"string"==typeof t.eccurvename?(this.ecprvhex=t.ecprvhex,this.eccurvename=t.eccurvename):this.prvKey=t,this.state="SIGN"},this.initVerifyByPublicKey=function(t){"string"==typeof t.ecpubhex&&"string"==typeof t.eccurvename?(this.ecpubhex=t.ecpubhex,this.eccurvename=t.eccurvename):t instanceof KJUR.crypto.ECDSA?this.pubKey=t:t instanceof RSAKey&&(this.pubKey=t),this.state="VERIFY"},this.initVerifyByCertificatePEM=function(t){var e=new X509;e.readCertPEM(t),this.pubKey=e.subjectPublicKeyRSA,this.state="VERIFY"},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var t=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof RSAKey&&"rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof RSAKey&&"rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof KJUR.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof KJUR.crypto.DSA))throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new KJUR.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,t,this.ecpubhex);if(this.pubKey instanceof RSAKey&&"rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof RSAKey&&"rsa"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof KJUR.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof KJUR.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.initVerifyByPublicKey=function(t){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName},this.initVerifyByCertificatePEM=function(t){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName},this.initSign=function(t){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},void 0!==(this.initParams=t)&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{(e=new RSAKey).readPrivateKeyFromPEMString(t.prvkeypem),this.initSign(e)}catch(t){throw"fatal error to load pem private key: "+t}}},KJUR.crypto.Cipher=function(t){},KJUR.crypto.Cipher.encrypt=function(t,e,r){if(e instanceof RSAKey&&e.isPublic){var i=KJUR.crypto.Cipher.getAlgByKeyAndName(e,r);if("RSA"===i)return e.encrypt(t);if("RSAOAEP"===i)return e.encryptOAEP(t,"sha1");var n=i.match(/^RSAOAEP(\d+)$/);if(null!==n)return e.encryptOAEP(t,"sha"+n[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.encrypt: unsupported key or algorithm"},KJUR.crypto.Cipher.decrypt=function(t,e,r){if(e instanceof RSAKey&&e.isPrivate){var i=KJUR.crypto.Cipher.getAlgByKeyAndName(e,r);if("RSA"===i)return e.decrypt(t);if("RSAOAEP"===i)return e.decryptOAEP(t,"sha1");var n=i.match(/^RSAOAEP(\d+)$/);if(null!==n)return e.decryptOAEP(t,"sha"+n[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.decrypt: unsupported key or algorithm"},KJUR.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof RSAKey){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e))return e;if(null==e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.lang&&KJUR.lang||(KJUR.lang={}),KJUR.lang.String=function(){},"function"==typeof Buffer?(utf8tob64u=function(t){return b64tob64u(new Buffer(t,"utf8").toString("base64"))},b64utoutf8=function(t){return new Buffer(b64utob64(t),"base64").toString("utf8")}):(utf8tob64u=function(t){return hextob64u(uricmptohex(encodeURIComponentAll(t)))},b64utoutf8=function(t){return decodeURIComponent(hextouricmp(b64utohex(t)))}),KJUR.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},KJUR.lang.String.isHex=function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))},KJUR.lang.String.isBase64=function(t){return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},KJUR.lang.String.isBase64URL=function(t){return!t.match(/[+/=]/)&&(t=b64utob64(t),KJUR.lang.String.isBase64(t))},KJUR.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)};var strdiffidx=function(t,e){var r=t.length;t.length>e.length&&(r=e.length);for(var i=0;i<r;i++)if(t.charCodeAt(i)!=e.charCodeAt(i))return i;return t.length!=e.length?r:-1};function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(t){var e,r,i;for(e=0;e<256;++e)this.S[e]=e;for(e=r=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[r],this.S[r]=i;this.i=0,this.j=0}function ARC4next(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function prng_newstate(){return new Arcfour}Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_state,rng_pool,rng_pptr,rng_psize=256;function rng_seed_int(t){rng_pool[rng_pptr++]^=255&t,rng_pool[rng_pptr++]^=t>>8&255,rng_pool[rng_pptr++]^=t>>16&255,rng_pool[rng_pptr++]^=t>>24&255,rng_psize<=rng_pptr&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}if(null==rng_pool){var t;if(rng_pool=new Array,rng_pptr=0,"Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=255&z.charCodeAt(t)}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=255&t;rng_pptr=0,rng_seed_time()}function rng_get_byte(){if(null==rng_state){for(rng_seed_time(),(rng_state=prng_newstate()).init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(t){var e;for(e=0;e<t.length;++e)t[e]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;var jsonParse=function(){var f=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),p=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),i={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function l(t,e,r){return e?i[e]:String.fromCharCode(parseInt(r,16))}var d=new String(""),S=(Object,Array,Object.hasOwnProperty);return function(t,a){var e,r,i=t.match(f),n=i[0],o=!1;"{"===n?e={}:"["===n?e=[]:(e=[],o=!0);for(var s=[e],h=1-o,u=i.length;h<u;++h){var g;switch((n=i[h]).charCodeAt(0)){default:(g=s[0])[r||g.length]=+n,r=void 0;break;case 34:if(-1!==(n=n.substring(1,n.length-1)).indexOf("\\")&&(n=n.replace(p,l)),g=s[0],!r){if(!(g instanceof Array)){r=n||d;break}r=g.length}g[r]=n,r=void 0;break;case 91:g=s[0],s.unshift(g[r||g.length]=[]),r=void 0;break;case 93:s.shift();break;case 102:(g=s[0])[r||g.length]=!1,r=void 0;break;case 110:(g=s[0])[r||g.length]=null,r=void 0;break;case 116:(g=s[0])[r||g.length]=!0,r=void 0;break;case 123:g=s[0],s.unshift(g[r||g.length]={}),r=void 0;break;case 125:s.shift()}}if(o){if(1!==s.length)throw new Error;e=e[0]}else if(s.length)throw new Error;if(a){var c=function(t,e){var r=t[e];if(r&&"object"==typeof r){var i=null;for(var n in r)if(S.call(r,n)&&r!==t){var o=c(r,n);void 0!==o?r[n]=o:(i||(i=[]),i.push(n))}if(i)for(var s=i.length;0<=--s;)delete r[i[s]]}return a.call(t,e,r)};e=c({"":e},"")}return e}}();void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.jws&&KJUR.jws||(KJUR.jws={}),KJUR.jws.JWS=function(){var c=KJUR.jws.JWS;this.parseJWS=function(t,e){if(void 0===this.parsedJWS||!e&&void 0===this.parsedJWS.sigvalH){var r=t.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==r)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=r[1],n=r[2],o=r[3],s=i+"."+n;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=n,this.parsedJWS.sigvalB64U=o,this.parsedJWS.si=s,!e){var a=b64utohex(o),h=parseBigInt(a,16);this.parsedJWS.sigvalH=a,this.parsedJWS.sigvalBI=h}var u=b64utoutf8(i),g=b64utoutf8(n);if(this.parsedJWS.headS=u,this.parsedJWS.payloadS=g,!c.isSafeJSONString(u,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+u}}},KJUR.jws.JWS.sign=function(t,e,r,i,n){var o,s,a,h=KJUR.jws.JWS;if("string"!=typeof e&&"object"!=typeof e)throw"spHeader must be JSON string or object: "+e;if("object"==typeof e&&(s=e,o=JSON.stringify(s)),"string"==typeof e){if(o=e,!h.isSafeJSONString(o))throw"JWS Head is not safe JSON string: "+o;s=h.readSafeJSONString(o)}if("object"==typeof(a=r)&&(a=JSON.stringify(r)),""!=t&&null!=t||void 0===s.alg||(t=s.alg),""!=t&&null!=t&&void 0===s.alg&&(s.alg=t,o=JSON.stringify(s)),t!==s.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+s.alg;var u=null;if(void 0===h.jwsalg2sigalg[t])throw"unsupported alg name: "+t;u=h.jwsalg2sigalg[t];var g=utf8tob64u(o)+"."+utf8tob64u(a),c="";if("Hmac"==u.substr(0,4)){if(void 0===i)throw"mac key shall be specified for HS* alg";var f=new KJUR.crypto.Mac({alg:u,prov:"cryptojs",pass:i});f.updateString(g),c=f.doFinal()}else if(-1!=u.indexOf("withECDSA")){(p=new KJUR.crypto.Signature({alg:u})).init(i,n),p.updateString(g),hASN1Sig=p.sign(),c=KJUR.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else if("none"!=u){var p;(p=new KJUR.crypto.Signature({alg:u})).init(i,n),p.updateString(g),c=p.sign()}return g+"."+hextob64u(c)},KJUR.jws.JWS.verify=function(t,e,r){var i,n=KJUR.jws.JWS,o=t.split("."),s=o[0]+"."+o[1],a=b64utohex(o[2]),h=n.readSafeJSONString(b64utoutf8(o[0])),u=null;if(void 0===h.alg)throw"algorithm not specified in header";if((i=(u=h.alg).substr(0,2),null!=r&&"[object Array]"===Object.prototype.toString.call(r)&&0<r.length)&&-1==(":"+r.join(":")+":").indexOf(":"+u+":"))throw"algorithm '"+u+"' not accepted in the list";if("none"!=u&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&(e=KEYUTIL.getKey(e)),!("RS"!=i&&"PS"!=i||e instanceof RSAKey))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==i&&!(e instanceof KJUR.crypto.ECDSA))throw"key shall be a ECDSA obj for ES* algs";var g=null;if(void 0===n.jwsalg2sigalg[h.alg])throw"unsupported alg name: "+u;if("none"==(g=n.jwsalg2sigalg[u]))throw"not supported";if("Hmac"==g.substr(0,4)){if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var c=new KJUR.crypto.Mac({alg:g,pass:e});return c.updateString(s),a==c.doFinal()}if(-1!=g.indexOf("withECDSA")){var f,p=null;try{p=KJUR.crypto.ECDSA.concatSigToASN1Sig(a)}catch(t){return!1}return(f=new KJUR.crypto.Signature({alg:g})).init(e),f.updateString(s),f.verify(p)}return(f=new KJUR.crypto.Signature({alg:g})).init(e),f.updateString(s),f.verify(a)},KJUR.jws.JWS.parse=function(t){var e,r,i,n=t.split("."),o={};if(2!=n.length&&3!=n.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=n[0],r=n[1],3==n.length&&(i=n[2]),o.headerObj=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(e)),o.payloadObj=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(r)),o.headerPP=JSON.stringify(o.headerObj,null,"  "),null==o.payloadObj?o.payloadPP=b64utoutf8(r):o.payloadPP=JSON.stringify(o.payloadObj,null,"  "),void 0!==i&&(o.sigHex=b64utohex(i)),o},KJUR.jws.JWS.verifyJWT=function(t,e,r){var i=KJUR.jws.JWS,n=t.split("."),o=n[0],s=n[1],a=(b64utohex(n[2]),i.readSafeJSONString(b64utoutf8(o))),h=i.readSafeJSONString(b64utoutf8(s));if(void 0===a.alg)return!1;if(void 0===r.alg)throw"acceptField.alg shall be specified";if(!i.inArray(a.alg,r.alg))return!1;if(void 0!==h.iss&&"object"==typeof r.iss&&!i.inArray(h.iss,r.iss))return!1;if(void 0!==h.sub&&"object"==typeof r.sub&&!i.inArray(h.sub,r.sub))return!1;if(void 0!==h.aud&&"object"==typeof r.aud)if("string"==typeof h.aud){if(!i.inArray(h.aud,r.aud))return!1}else if("object"==typeof h.aud&&!i.includedArray(h.aud,r.aud))return!1;var u=KJUR.jws.IntDate.getNow();return void 0!==r.verifyAt&&"number"==typeof r.verifyAt&&(u=r.verifyAt),void 0!==r.gracePeriod&&"number"==typeof r.gracePeriod||(r.gracePeriod=0),!(void 0!==h.exp&&"number"==typeof h.exp&&h.exp+r.gracePeriod<u||void 0!==h.nbf&&"number"==typeof h.nbf&&u<h.nbf-r.gracePeriod||void 0!==h.iat&&"number"==typeof h.iat&&u<h.iat-r.gracePeriod||void 0!==h.jti&&void 0!==r.jti&&h.jti!==r.jti||!KJUR.jws.JWS.verify(t,e,r.alg))},KJUR.jws.JWS.includedArray=function(t,e){var r=KJUR.jws.JWS.inArray;if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var i=0;i<t.length;i++)if(!r(t[i],e))return!1;return!0},KJUR.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var r=0;r<e.length;r++)if(e[r]==t)return!0;return!1},KJUR.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},KJUR.jws.JWS.isSafeJSONString=function(t,e,r){var i=null;try{return"object"!=typeof(i=jsonParse(t))?0:i.constructor===Array?0:(e&&(e[r]=i),1)}catch(t){return 0}},KJUR.jws.JWS.readSafeJSONString=function(t){var e=null;try{return"object"!=typeof(e=jsonParse(t))?null:e.constructor===Array?null:e}catch(t){return null}},KJUR.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},KJUR.jws.JWS.getJWKthumbprint=function(t){if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var r=rstrtohex(e);return hextob64u(KJUR.crypto.Util.hashHex(r,"sha256"))},KJUR.jws.IntDate={},KJUR.jws.IntDate.get=function(t){if("now"==t)return KJUR.jws.IntDate.getNow();if("now + 1hour"==t)return KJUR.jws.IntDate.getNow()+3600;if("now + 1day"==t)return KJUR.jws.IntDate.getNow()+86400;if("now + 1month"==t)return KJUR.jws.IntDate.getNow()+2592e3;if("now + 1year"==t)return KJUR.jws.IntDate.getNow()+31536e3;if(t.match(/Z$/))return KJUR.jws.IntDate.getZulu(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},KJUR.jws.IntDate.getZulu=function(t){var e=t.match(/(\d+)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z/);if(e){var r=e[1],i=parseInt(r);if(4==r.length);else{if(2!=r.length)throw"malformed year string";if(50<=i&&i<100)i=1900+i;else{if(!(0<=i&&i<50))throw"malformed year string for UTCTime";i=2e3+i}}var n=parseInt(e[2])-1,o=parseInt(e[3]),s=parseInt(e[4]),a=parseInt(e[5]),h=parseInt(e[6]);return~~(new Date(Date.UTC(i,n,o,s,a,h))/1e3)}throw"unsupported format: "+t},KJUR.jws.IntDate.getNow=function(){return~~(new Date/1e3)},KJUR.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},KJUR.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t);return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"};var KEYUTIL=function(){var t=function(t,e,r){return i(CryptoJS.AES,t,e,r)},i=function(t,e,r,i){var n=CryptoJS.enc.Hex.parse(e),o=CryptoJS.enc.Hex.parse(r),s=CryptoJS.enc.Hex.parse(i),a={};a.key=o,a.iv=s,a.ciphertext=n;var h=t.decrypt(a,o,{iv:s});return CryptoJS.enc.Hex.stringify(h)},e=function(t,e,r){return n(CryptoJS.AES,t,e,r)},n=function(t,e,r,i){var n=CryptoJS.enc.Hex.parse(e),o=CryptoJS.enc.Hex.parse(r),s=CryptoJS.enc.Hex.parse(i),a=t.encrypt(n,o,{iv:s}),h=CryptoJS.enc.Hex.parse(a.toString());return CryptoJS.enc.Base64.stringify(h)},p={"AES-256-CBC":{proc:t,eproc:e,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:e,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:e,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(t,e,r){return i(CryptoJS.TripleDES,t,e,r)},eproc:function(t,e,r){return n(CryptoJS.TripleDES,t,e,r)},keylen:24,ivlen:8},"DES-CBC":{proc:function(t,e,r){return i(CryptoJS.DES,t,e,r)},eproc:function(t,e,r){return n(CryptoJS.DES,t,e,r)},keylen:8,ivlen:8}},a=function(t){var e={},r=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));r&&(e.cipher=r[1],e.ivsalt=r[2]);var i=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));i&&(e.type=i[1]);var n=-1,o=0;-1!=t.indexOf("\r\n\r\n")&&(n=t.indexOf("\r\n\r\n"),o=2),-1!=t.indexOf("\n\n")&&(n=t.indexOf("\n\n"),o=1);var s=t.indexOf("-----END");if(-1!=n&&-1!=s){var a=t.substring(n+2*o,s-o);a=a.replace(/\s+/g,""),e.data=a}return e},l=function(t,e,r){for(var i=r.substring(0,16),n=CryptoJS.enc.Hex.parse(i),o=CryptoJS.enc.Utf8.parse(e),s=p[t].keylen+p[t].ivlen,a="",h=null;;){var u=CryptoJS.algo.MD5.create();if(null!=h&&u.update(h),u.update(o),u.update(n),h=u.finalize(),(a+=CryptoJS.enc.Hex.stringify(h)).length>=2*s)break}var g={};return g.keyhex=a.substr(0,2*p[t].keylen),g.ivhex=a.substr(2*p[t].keylen,2*p[t].ivlen),g},h=function(t,e,r,i){var n=CryptoJS.enc.Base64.parse(t),o=CryptoJS.enc.Hex.stringify(n);return(0,p[e].proc)(o,r,i)};return{version:"1.0.0",getHexFromPEM:function(t,e){var r=t;if(-1==r.indexOf("-----BEGIN "))throw"can't find PEM header: "+e;return"string"==typeof e&&""!=e?r=(r=r.replace("-----BEGIN "+e+"-----","")).replace("-----END "+e+"-----",""):r=(r=r.replace(/-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----/,""),b64tohex(r.replace(/\s+/g,""))},getDecryptedKeyHexByKeyIV:function(t,e,r,i){return(0,p[e].proc)(t,r,i)},parsePKCS5PEM:function(t){return a(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,r){return l(t,e,r)},decryptKeyB64:function(t,e,r,i){return h(t,e,r,i)},getDecryptedKeyHex:function(t,e){var r=a(t),i=(r.type,r.cipher),n=r.ivsalt,o=r.data,s=l(i,e,n).keyhex;return h(o,i,s,n)},getRSAKeyFromEncryptedPKCS5PEM:function(t,e){var r=this.getDecryptedKeyHex(t,e),i=new RSAKey;return i.readPrivateKeyFromASN1HexString(r),i},getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,r,i,n){var o,s,a="";if(void 0!==i&&null!=i||(i="AES-256-CBC"),void 0===p[i])throw"KEYUTIL unsupported algorithm: "+i;if(void 0===n||null==n){var h=p[i].ivlen;n=(o=h,s=CryptoJS.lib.WordArray.random(o),CryptoJS.enc.Hex.stringify(s)).toUpperCase()}var u,g,c,f=l(i,r,n).keyhex;a="-----BEGIN "+t+" PRIVATE KEY-----\r\n";return a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+i+","+n+"\r\n",a+="\r\n",(a+=(u=e,g=f,c=n,(0,p[i].eproc)(u,g,c)).replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+t+" PRIVATE KEY-----\r\n"},getEncryptedPKCS5PEMFromRSAKey:function(t,e,r,i){var n=new KJUR.asn1.DERInteger({int:0}),o=new KJUR.asn1.DERInteger({bigint:t.n}),s=new KJUR.asn1.DERInteger({int:t.e}),a=new KJUR.asn1.DERInteger({bigint:t.d}),h=new KJUR.asn1.DERInteger({bigint:t.p}),u=new KJUR.asn1.DERInteger({bigint:t.q}),g=new KJUR.asn1.DERInteger({bigint:t.dmp1}),c=new KJUR.asn1.DERInteger({bigint:t.dmq1}),f=new KJUR.asn1.DERInteger({bigint:t.coeff}),p=new KJUR.asn1.DERSequence({array:[n,o,s,a,h,u,g,c,f]}).getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",p,e,r,i)},newEncryptedPKCS5PEM:function(t,e,r,i){void 0!==e&&null!=e||(e=1024),void 0!==r&&null!=r||(r="10001");var n=new RSAKey;n.generate(e,r);return void 0===i||null==i?this.getEncryptedPKCS5PEMFromRSAKey(n,t):this.getEncryptedPKCS5PEMFromRSAKey(n,t,i)},getRSAKeyFromPlainPKCS8PEM:function(t){if(t.match(/ENCRYPTED/))throw"pem shall be not ENCRYPTED";var e=this.getHexFromPEM(t,"PRIVATE KEY");return this.getRSAKeyFromPlainPKCS8Hex(e)},getRSAKeyFromPlainPKCS8Hex:function(t){var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(3!=e.length)throw"outer DERSequence shall have 3 elements: "+e.length;if("300d06092a864886f70d0101010500"!=(r=ASN1HEX.getHexOfTLV_AtObj(t,e[1])))throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+r;var r=ASN1HEX.getHexOfTLV_AtObj(t,e[1]),i=ASN1HEX.getHexOfTLV_AtObj(t,e[2]),n=ASN1HEX.getHexOfV_AtObj(i,0),o=new RSAKey;return o.readPrivateKeyFromASN1HexString(n),o},parseHexOfEncryptedPKCS8:function(t){var e={},r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=r.length)throw"malformed format: SEQUENCE(0).items != 2: "+r.length;e.ciphertext=ASN1HEX.getHexOfV_AtObj(t,r[1]);var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,r[0]);if(2!=i.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+i.length;if("2a864886f70d01050d"!=ASN1HEX.getHexOfV_AtObj(t,i[0]))throw"this only supports pkcs5PBES2";var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,i[1]);if(2!=i.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+n.length;var o=ASN1HEX.getPosArrayOfChildren_AtObj(t,n[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+o.length;if("2a864886f70d0307"!=ASN1HEX.getHexOfV_AtObj(t,o[0]))throw"this only supports TripleDES";e.encryptionSchemeAlg="TripleDES",e.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(t,o[1]);var s=ASN1HEX.getPosArrayOfChildren_AtObj(t,n[0]);if(2!=s.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+s.length;if("2a864886f70d01050c"!=ASN1HEX.getHexOfV_AtObj(t,s[0]))throw"this only supports pkcs5PBKDF2";var a=ASN1HEX.getPosArrayOfChildren_AtObj(t,s[1]);if(a.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+a.length;e.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(t,a[0]);var h=ASN1HEX.getHexOfV_AtObj(t,a[1]);try{e.pbkdf2Iter=parseInt(h,16)}catch(t){throw"malformed format pbkdf2Iter: "+h}return e},getPBKDF2KeyHexFromParam:function(t,e){var r=CryptoJS.enc.Hex.parse(t.pbkdf2Salt),i=t.pbkdf2Iter,n=CryptoJS.PBKDF2(e,r,{keySize:6,iterations:i});return CryptoJS.enc.Hex.stringify(n)},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var r=this.getHexFromPEM(t,"ENCRYPTED PRIVATE KEY"),i=this.parseHexOfEncryptedPKCS8(r),n=KEYUTIL.getPBKDF2KeyHexFromParam(i,e),o={};o.ciphertext=CryptoJS.enc.Hex.parse(i.ciphertext);var s=CryptoJS.enc.Hex.parse(n),a=CryptoJS.enc.Hex.parse(i.encryptionSchemeIV),h=CryptoJS.TripleDES.decrypt(o,s,{iv:a});return CryptoJS.enc.Hex.stringify(h)},getRSAKeyFromEncryptedPKCS8PEM:function(t,e){var r=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getRSAKeyFromPlainPKCS8Hex(r)},getKeyFromEncryptedPKCS8PEM:function(t,e){var r=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(r)},parsePlainPrivatePKCS8Hex:function(t){var e={algparam:null};if("30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(3!=r.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(r[1],2))throw"malformed PKCS8 private key(code:003)";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,r[1]);if(2!=i.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(i[0],2))throw"malformed PKCS8 private key(code:005)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(t,i[0]),"06"==t.substr(i[1],2)&&(e.algparam=ASN1HEX.getHexOfV_AtObj(t,i[1])),"04"!=t.substr(r[2],2))throw"malformed PKCS8 private key(code:006)";return e.keyidx=ASN1HEX.getStartPosOfV_AtObj(t,r[2]),e},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==e.algoid){this.parsePrivateRawRSAKeyHexAtObj(t,e);var r=e.key;return(n=new RSAKey).setPrivateEx(r.n,r.e,r.d,r.p,r.q,r.dp,r.dq,r.co),n}if("2a8648ce3d0201"==e.algoid){if(this.parsePrivateRawECKeyHexAtObj(t,e),void 0===KJUR.crypto.OID.oidhex2name[e.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+e.algparam;var i=KJUR.crypto.OID.oidhex2name[e.algparam];return(n=new KJUR.crypto.ECDSA({curve:i})).setPublicKeyHex(e.pubkey),n.setPrivateKeyHex(e.key),n.isPublic=!1,n}if("2a8648ce380401"==e.algoid){var n,o=ASN1HEX.getVbyList(t,0,[1,1,0],"02"),s=ASN1HEX.getVbyList(t,0,[1,1,1],"02"),a=ASN1HEX.getVbyList(t,0,[1,1,2],"02"),h=ASN1HEX.getVbyList(t,0,[2,0],"02"),u=new BigInteger(o,16),g=new BigInteger(s,16),c=new BigInteger(a,16),f=new BigInteger(h,16);return(n=new KJUR.crypto.DSA).setPrivate(u,g,c,null,f),n}throw"unsupported private key algorithm"},getRSAKeyFromPublicPKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PUBLIC KEY");return this.getRSAKeyFromPublicPKCS8Hex(e)},getKeyFromPublicPKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PUBLIC KEY");return this.getKeyFromPublicPKCS8Hex(e)},getKeyFromPublicPKCS8Hex:function(t){var e=this.parsePublicPKCS8Hex(t);if("2a864886f70d010101"==e.algoid){var r=this.parsePublicRawRSAKeyHex(e.key);return(n=new RSAKey).setPublic(r.n,r.e),n}if("2a8648ce3d0201"==e.algoid){if(void 0===KJUR.crypto.OID.oidhex2name[e.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+e.algparam;var i=KJUR.crypto.OID.oidhex2name[e.algparam];return n=new KJUR.crypto.ECDSA({curve:i,pub:e.key})}if("2a8648ce380401"==e.algoid){var n,o=e.algparam,s=ASN1HEX.getHexOfV_AtObj(e.key,0);return(n=new KJUR.crypto.DSA).setPublic(new BigInteger(o.p,16),new BigInteger(o.q,16),new BigInteger(o.g,16),new BigInteger(s,16)),n}throw"unsupported public key algorithm"},parsePublicRawRSAKeyHex:function(t){var e={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=r.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(r[0],2))throw"malformed RSA key(code:003)";if(e.n=ASN1HEX.getHexOfV_AtObj(t,r[0]),"02"!=t.substr(r[1],2))throw"malformed RSA key(code:004)";return e.e=ASN1HEX.getHexOfV_AtObj(t,r[1]),e},parsePrivateRawRSAKeyHexAtObj:function(t,e){var r=e.keyidx;if("30"!=t.substr(r,2))throw"malformed RSA private key(code:001)";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,r);if(9!=i.length)throw"malformed RSA private key(code:002)";e.key={},e.key.n=ASN1HEX.getHexOfV_AtObj(t,i[1]),e.key.e=ASN1HEX.getHexOfV_AtObj(t,i[2]),e.key.d=ASN1HEX.getHexOfV_AtObj(t,i[3]),e.key.p=ASN1HEX.getHexOfV_AtObj(t,i[4]),e.key.q=ASN1HEX.getHexOfV_AtObj(t,i[5]),e.key.dp=ASN1HEX.getHexOfV_AtObj(t,i[6]),e.key.dq=ASN1HEX.getHexOfV_AtObj(t,i[7]),e.key.co=ASN1HEX.getHexOfV_AtObj(t,i[8])},parsePrivateRawECKeyHexAtObj:function(t,e){var r=e.keyidx,i=ASN1HEX.getVbyList(t,r,[1],"04"),n=ASN1HEX.getVbyList(t,r,[2,0],"03").substr(2);e.key=i,e.pubkey=n},parsePublicPKCS8Hex:function(t){var e={algparam:null},r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=r.length)throw"outer DERSequence shall have 2 elements: "+r.length;var i=r[0];if("30"!=t.substr(i,2))throw"malformed PKCS8 public key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,i);if(2!=n.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(n[0],2))throw"malformed PKCS8 public key(code:003)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(t,n[0]),"06"==t.substr(n[1],2)?e.algparam=ASN1HEX.getHexOfV_AtObj(t,n[1]):"30"==t.substr(n[1],2)&&(e.algparam={},e.algparam.p=ASN1HEX.getVbyList(t,n[1],[0],"02"),e.algparam.q=ASN1HEX.getVbyList(t,n[1],[1],"02"),e.algparam.g=ASN1HEX.getVbyList(t,n[1],[2],"02")),"03"!=t.substr(r[1],2))throw"malformed PKCS8 public key(code:004)";return e.key=ASN1HEX.getHexOfV_AtObj(t,r[1]).substr(2),e},getRSAKeyFromPublicPKCS8Hex:function(t){var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=e.length)throw"outer DERSequence shall have 2 elements: "+e.length;if("300d06092a864886f70d0101010500"!=ASN1HEX.getHexOfTLV_AtObj(t,e[0]))throw"PKCS8 AlgorithmId is not rsaEncryption";if("03"!=t.substr(e[1],2))throw"PKCS8 Public Key is not BITSTRING encapslated.";var r=ASN1HEX.getStartPosOfV_AtObj(t,e[1])+2;if("30"!=t.substr(r,2))throw"PKCS8 Public Key is not SEQUENCE.";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,r);if(2!=i.length)throw"inner DERSequence shall have 2 elements: "+i.length;if("02"!=t.substr(i[0],2))throw"N is not ASN.1 INTEGER";if("02"!=t.substr(i[1],2))throw"E is not ASN.1 INTEGER";var n=ASN1HEX.getHexOfV_AtObj(t,i[0]),o=ASN1HEX.getHexOfV_AtObj(t,i[1]),s=new RSAKey;return s.setPublic(n,o),s}}}();KEYUTIL.getKey=function(t,e,r){if(void 0!==RSAKey&&t instanceof RSAKey)return t;if(void 0!==KJUR.crypto.ECDSA&&t instanceof KJUR.crypto.ECDSA)return t;if(void 0!==KJUR.crypto.DSA&&t instanceof KJUR.crypto.DSA)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new KJUR.crypto.ECDSA({pub:t.xy,curve:t.curve});if(void 0!==t.curve&&void 0!==t.d)return new KJUR.crypto.ECDSA({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(d=new RSAKey).setPublic(t.n,t.e),d;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi)return(d=new RSAKey).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),d;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p)return(d=new RSAKey).setPrivate(t.n,t.e,t.d),d;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(d=new KJUR.crypto.DSA).setPublic(t.p,t.q,t.g,t.y),d;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(d=new KJUR.crypto.DSA).setPrivate(t.p,t.q,t.g,t.y,t.x),d;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(d=new RSAKey).setPublic(b64utohex(t.n),b64utohex(t.e)),d;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi)return(d=new RSAKey).setPrivateEx(b64utohex(t.n),b64utohex(t.e),b64utohex(t.d),b64utohex(t.p),b64utohex(t.q),b64utohex(t.dp),b64utohex(t.dq),b64utohex(t.qi)),d;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d)return(d=new RSAKey).setPrivate(b64utohex(t.n),b64utohex(t.e),b64utohex(t.d)),d;if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){var i=(l=new KJUR.crypto.ECDSA({curve:t.crv})).ecparams.keylen/4,n="04"+("0000000000"+b64utohex(t.x)).slice(-i)+("0000000000"+b64utohex(t.y)).slice(-i);return l.setPublicKeyHex(n),l}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){i=(l=new KJUR.crypto.ECDSA({curve:t.crv})).ecparams.keylen/4,n="04"+("0000000000"+b64utohex(t.x)).slice(-i)+("0000000000"+b64utohex(t.y)).slice(-i);var o=("0000000000"+b64utohex(t.d)).slice(-i);return l.setPublicKeyHex(n),l.setPrivateKeyHex(o),l}if(-1!=t.indexOf("-END CERTIFICATE-",0)||-1!=t.indexOf("-END X509 CERTIFICATE-",0)||-1!=t.indexOf("-END TRUSTED CERTIFICATE-",0))return X509.getPublicKeyFromCertPEM(t);if("pkcs8pub"===r)return KEYUTIL.getKeyFromPublicPKCS8Hex(t);if(-1!=t.indexOf("-END PUBLIC KEY-"))return KEYUTIL.getKeyFromPublicPKCS8PEM(t);if("pkcs5prv"===r)return(d=new RSAKey).readPrivateKeyFromASN1HexString(t),d;if("pkcs5prv"===r)return(d=new RSAKey).readPrivateKeyFromASN1HexString(t),d;if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var s=KEYUTIL.getHexFromPEM(t,"RSA PRIVATE KEY");return KEYUTIL.getKey(s,null,"pkcs5prv")}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var a=this.getHexFromPEM(t,"DSA PRIVATE KEY"),h=ASN1HEX.getVbyList(a,0,[1],"02"),u=ASN1HEX.getVbyList(a,0,[2],"02"),g=ASN1HEX.getVbyList(a,0,[3],"02"),c=ASN1HEX.getVbyList(a,0,[4],"02"),f=ASN1HEX.getVbyList(a,0,[5],"02");return(d=new KJUR.crypto.DSA).setPrivate(new BigInteger(h,16),new BigInteger(u,16),new BigInteger(g,16),new BigInteger(c,16),new BigInteger(f,16)),d}if(-1!=t.indexOf("-END PRIVATE KEY-"))return KEYUTIL.getKeyFromPlainPrivatePKCS8PEM(t);if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED"))return KEYUTIL.getRSAKeyFromEncryptedPKCS5PEM(t,e);if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){a=KEYUTIL.getDecryptedKeyHex(t,e);var p,l,d=ASN1HEX.getVbyList(a,0,[1],"04"),S=ASN1HEX.getVbyList(a,0,[2,0],"06"),y=ASN1HEX.getVbyList(a,0,[3,0],"03").substr(2);if(void 0===KJUR.crypto.OID.oidhex2name[S])throw"undefined OID(hex) in KJUR.crypto.OID: "+S;return p=KJUR.crypto.OID.oidhex2name[S],(l=new KJUR.crypto.ECDSA({name:p})).setPublicKeyHex(y),l.setPrivateKeyHex(d),l.isPublic=!1,l}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){a=KEYUTIL.getDecryptedKeyHex(t,e),h=ASN1HEX.getVbyList(a,0,[1],"02"),u=ASN1HEX.getVbyList(a,0,[2],"02"),g=ASN1HEX.getVbyList(a,0,[3],"02"),c=ASN1HEX.getVbyList(a,0,[4],"02"),f=ASN1HEX.getVbyList(a,0,[5],"02");return(d=new KJUR.crypto.DSA).setPrivate(new BigInteger(h,16),new BigInteger(u,16),new BigInteger(g,16),new BigInteger(c,16),new BigInteger(f,16)),d}if(-1!=t.indexOf("-END ENCRYPTED PRIVATE KEY-"))return KEYUTIL.getKeyFromEncryptedPKCS8PEM(t,e);throw"not supported argument"},KEYUTIL.generateKeypair=function(t,e){if("RSA"==t){var r=e;(s=new RSAKey).generate(r,"10001"),s.isPrivate=!0,s.isPublic=!0;var i=new RSAKey,n=s.n.toString(16),o=s.e.toString(16);return i.setPublic(n,o),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=i,a}if("EC"==t){var s,a,h=e,u=new KJUR.crypto.ECDSA({curve:h}).generateKeyPairHex();return(s=new KJUR.crypto.ECDSA({curve:h})).setPublicKeyHex(u.ecpubhex),s.setPrivateKeyHex(u.ecprvhex),s.isPrivate=!0,s.isPublic=!1,(i=new KJUR.crypto.ECDSA({curve:h})).setPublicKeyHex(u.ecpubhex),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=i,a}throw"unknown algorithm: "+t},KEYUTIL.getPEM=function(t,e,r,i,n){function o(t){return KJUR.asn1.ASN1Util.newObject({seq:[{int:0},{int:{bigint:t.n}},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]})}function s(t){return KJUR.asn1.ASN1Util.newObject({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]})}function a(t){return KJUR.asn1.ASN1Util.newObject({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{bigint:t.y}},{int:{bigint:t.x}}]})}var h=KJUR.asn1,u=KJUR.crypto;if((void 0!==RSAKey&&t instanceof RSAKey||void 0!==u.DSA&&t instanceof u.DSA||void 0!==u.ECDSA&&t instanceof u.ECDSA)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e)){var g=new KJUR.asn1.x509.SubjectPublicKeyInfo(t).getEncodedHex();return h.ASN1Util.getPEMStringFromHex(g,"PUBLIC KEY")}if("PKCS1PRV"==e&&void 0!==RSAKey&&t instanceof RSAKey&&(void 0===r||null==r)&&1==t.isPrivate){g=o(t).getEncodedHex();return h.ASN1Util.getPEMStringFromHex(g,"RSA PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==RSAKey&&t instanceof KJUR.crypto.ECDSA&&(void 0===r||null==r)&&1==t.isPrivate){var c=new KJUR.asn1.DERObjectIdentifier({name:t.curveName}).getEncodedHex(),f=s(t).getEncodedHex(),p="";return(p+=h.ASN1Util.getPEMStringFromHex(c,"EC PARAMETERS"))+h.ASN1Util.getPEMStringFromHex(f,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==KJUR.crypto.DSA&&t instanceof KJUR.crypto.DSA&&(void 0===r||null==r)&&1==t.isPrivate){g=a(t).getEncodedHex();return h.ASN1Util.getPEMStringFromHex(g,"DSA PRIVATE KEY")}if("PKCS5PRV"==e&&void 0!==RSAKey&&t instanceof RSAKey&&void 0!==r&&null!=r&&1==t.isPrivate){g=o(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",g,r,i)}if("PKCS5PRV"==e&&void 0!==KJUR.crypto.ECDSA&&t instanceof KJUR.crypto.ECDSA&&void 0!==r&&null!=r&&1==t.isPrivate){g=s(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",g,r,i)}if("PKCS5PRV"==e&&void 0!==KJUR.crypto.DSA&&t instanceof KJUR.crypto.DSA&&void 0!==r&&null!=r&&1==t.isPrivate){g=a(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",g,r,i)}var l=function(t,e){var r=d(t,e);return new KJUR.asn1.ASN1Util.newObject({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:r.pbkdf2Salt}},{int:r.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:r.encryptionSchemeIV}}]}]}]},{octstr:{hex:r.ciphertext}}]}).getEncodedHex()},d=function(t,e){var r=CryptoJS.lib.WordArray.random(8),i=CryptoJS.lib.WordArray.random(8),n=CryptoJS.PBKDF2(e,r,{keySize:6,iterations:100}),o=CryptoJS.enc.Hex.parse(t),s=CryptoJS.TripleDES.encrypt(o,n,{iv:i})+"",a={};return a.ciphertext=s,a.pbkdf2Salt=CryptoJS.enc.Hex.stringify(r),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=CryptoJS.enc.Hex.stringify(i),a};if("PKCS8PRV"==e&&void 0!==RSAKey&&t instanceof RSAKey&&1==t.isPrivate){var S=o(t).getEncodedHex();g=KJUR.asn1.ASN1Util.newObject({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:S}}]}).getEncodedHex();if(void 0===r||null==r)return h.ASN1Util.getPEMStringFromHex(g,"PRIVATE KEY");f=l(g,r);return h.ASN1Util.getPEMStringFromHex(f,"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==KJUR.crypto.ECDSA&&t instanceof KJUR.crypto.ECDSA&&1==t.isPrivate){S=new KJUR.asn1.ASN1Util.newObject({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),g=KJUR.asn1.ASN1Util.newObject({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:S}}]}).getEncodedHex();if(void 0===r||null==r)return h.ASN1Util.getPEMStringFromHex(g,"PRIVATE KEY");f=l(g,r);return h.ASN1Util.getPEMStringFromHex(f,"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==KJUR.crypto.DSA&&t instanceof KJUR.crypto.DSA&&1==t.isPrivate){S=new KJUR.asn1.DERInteger({bigint:t.x}).getEncodedHex(),g=KJUR.asn1.ASN1Util.newObject({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:S}}]}).getEncodedHex();if(void 0===r||null==r)return h.ASN1Util.getPEMStringFromHex(g,"PRIVATE KEY");f=l(g,r);return h.ASN1Util.getPEMStringFromHex(f,"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},KEYUTIL.getKeyFromCSRPEM=function(t){var e=KEYUTIL.getHexFromPEM(t,"CERTIFICATE REQUEST");return KEYUTIL.getKeyFromCSRHex(e)},KEYUTIL.getKeyFromCSRHex=function(t){var e=KEYUTIL.parseCSRHex(t);return KEYUTIL.getKey(e.p8pubkeyhex,null,"pkcs8pub")},KEYUTIL.parseCSRHex=function(t){var e={},r=t;if("30"!=r.substr(0,2))throw"malformed CSR(code:001)";var i=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(i.length<1)throw"malformed CSR(code:002)";if("30"!=r.substr(i[0],2))throw"malformed CSR(code:003)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(r,i[0]);if(n.length<3)throw"malformed CSR(code:004)";return e.p8pubkeyhex=ASN1HEX.getHexOfTLV_AtObj(r,n[2]),e},KEYUTIL.getJWKFromKey=function(t){var e={};if(t instanceof RSAKey&&t.isPrivate)return e.kty="RSA",e.n=hextob64u(t.n.toString(16)),e.e=hextob64u(t.e.toString(16)),e.d=hextob64u(t.d.toString(16)),e.p=hextob64u(t.p.toString(16)),e.q=hextob64u(t.q.toString(16)),e.dp=hextob64u(t.dmp1.toString(16)),e.dq=hextob64u(t.dmq1.toString(16)),e.qi=hextob64u(t.coeff.toString(16)),e;if(t instanceof RSAKey&&t.isPublic)return e.kty="RSA",e.n=hextob64u(t.n.toString(16)),e.e=hextob64u(t.e.toString(16)),e;if(t instanceof KJUR.crypto.ECDSA&&t.isPrivate){if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;var r=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=hextob64u(r.x),e.y=hextob64u(r.y),e.d=hextob64u(t.prvKeyHex),e}if(t instanceof KJUR.crypto.ECDSA&&t.isPublic){var i;if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;r=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=hextob64u(r.x),e.y=hextob64u(r.y),e}throw"not supported key object"};